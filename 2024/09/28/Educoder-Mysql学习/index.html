

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="diba0">
  <meta name="keywords" content="blog, life, work">
  
    <meta name="description" content="根据Educoder实践课程数据库原理与应用——MySQL从入门到实战进行学习记录">
<meta property="og:type" content="article">
<meta property="og:title" content="Educoder MySQL学习">
<meta property="og:url" content="http://diba0.github.io/2024/09/28/Educoder-Mysql%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="diba0&#39;s blog">
<meta property="og:description" content="根据Educoder实践课程数据库原理与应用——MySQL从入门到实战进行学习记录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://diba0.github.io/img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.1.png">
<meta property="article:published_time" content="2024-09-28T08:39:26.000Z">
<meta property="article:modified_time" content="2024-10-21T00:38:54.871Z">
<meta property="article:author" content="diba0">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="Educoder">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://diba0.github.io/img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.1.png">
  
  
  
  <title>Educoder MySQL学习 - diba0&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"diba0.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>diba0&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Educoder MySQL学习"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-28 16:39" pubdate>
          2024年9月28日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          17k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          141 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Educoder MySQL学习</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2024年10月21日 早上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>根据Educoder实践课程<a target="_blank" rel="noopener" href="https://www.educoder.net/paths/bqcxmgje">数据库原理与应用——MySQL从入门到实战</a>进行学习记录</p>
<span id="more"></span>

<h1 id="1-MySQL数据定义与操作实战"><a href="#1-MySQL数据定义与操作实战" class="headerlink" title="1. MySQL数据定义与操作实战"></a>1. MySQL数据定义与操作实战</h1><h2 id="1-1-初视MySQL"><a href="#1-1-初视MySQL" class="headerlink" title="1.1 初视MySQL"></a>1.1 初视MySQL</h2><h3 id="1-1-1-创建数据库"><a href="#1-1-1-创建数据库" class="headerlink" title="1.1.1 创建数据库"></a>1.1.1 创建数据库</h3><ol>
<li>连接数据库<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -u`用户名` -p`密码`<br></code></pre></td></tr></table></figure></li>
<li>创建数据库<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database `数据库名`;<br></code></pre></td></tr></table></figure></li>
<li>查看数据库<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> databases;<br></code></pre></td></tr></table></figure></li>
<li>Educoder截图<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.1.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<h3 id="1-1-2-创建表"><a href="#1-1-2-创建表" class="headerlink" title="1.1.2 创建表"></a>1.1.2 创建表</h3><ol>
<li>创建表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> `表名`(<br>    `字段名` `数据类型`，<br>    `字段名` `数据类型`，<br>    ......<br>);<br></code></pre></td></tr></table></figure></li>
<li>在指定数据库中创建表（例子）<ol>
<li>创建数据库 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database MyDb;<br></code></pre></td></tr></table></figure></li>
<li>选择数据库 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">use MyDb;<br></code></pre></td></tr></table></figure></li>
<li>创建t_user表 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database t_user(<br>    id <span class="hljs-type">int</span>,<br>    username <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>),<br>    password <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>),<br>    phone <span class="hljs-type">varchar</span>(<span class="hljs-number">11</span>)<br>);<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li>查看表<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">describe</span> `表名`;<br></code></pre></td></tr></table></figure>
简写：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">desc</span> `表名`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder截图<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.2.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<h3 id="1-1-3-使用主键约束"><a href="#1-1-3-使用主键约束" class="headerlink" title="1.1.3 使用主键约束"></a>1.1.3 使用主键约束</h3><ol>
<li><p>在定义列的同时添加主键约束<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.3-1.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>在定义完所有列后添加主键约束<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.3-2.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>多字段联合主键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_emp2(<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>),<br>    deptId <span class="hljs-type">int</span>,<br>    salary <span class="hljs-type">float</span>,<br>    <span class="hljs-keyword">primary</span> key(name,deptId)<br>);<br></code></pre></td></tr></table></figure></li>
<li><p>删除表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> `表名`;<br></code></pre></td></tr></table></figure>
</li>
<li><p>Educoder截图<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.3-3.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<h3 id="1-1-4-外键约束"><a href="#1-1-4-外键约束" class="headerlink" title="1.1.4 外键约束"></a>1.1.4 外键约束</h3><ol>
<li>添加外部关键字<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">constraint</span> `外键名` <span class="hljs-keyword">foreign</span> key(`字段名`) <span class="hljs-keyword">references</span> `主表名(主键名)`<br></code></pre></td></tr></table></figure></li>
<li>创建两张表：t_emp和t_dept，并为t_emp添加外键(例子)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_dept(<br>    deptId <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">22</span>),<br>    location <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)<br>);<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_emp(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">22</span>),<br>    deptId <span class="hljs-type">int</span>,<br>    <span class="hljs-keyword">constraint</span> fk_emp_dept1 <span class="hljs-keyword">foreign</span> key(deptId) <span class="hljs-keyword">references</span> t_dept(deptId)<br>);<br></code></pre></td></tr></table></figure></li>
<li>Educoder截图<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.4.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<h3 id="1-1-5-添加常用约束"><a href="#1-1-5-添加常用约束" class="headerlink" title="1.1.5 添加常用约束"></a>1.1.5 添加常用约束</h3><ol>
<li>添加唯一约束，即字段的值不能出现相同值，关键词：<code>unique</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_dept(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">22</span>) <span class="hljs-keyword">unique</span>,<br>    location <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)<br>);<br></code></pre></td></tr></table></figure></li>
<li>添加非空约束，即字段的值不能为空，关键词：<code>null</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_dept(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">22</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    location <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)<br>);<br></code></pre></td></tr></table></figure></li>
<li>添加默认约束，即字段的值设置默认值，关键词：<code>default</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_emp(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">22</span>),<br>    sex <span class="hljs-type">varchar</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">&#x27;男&#x27;</span><br>) <span class="hljs-keyword">default</span> charset<span class="hljs-operator">=</span>utf8;<br></code></pre></td></tr></table></figure>
note: 添加中文默认值需要设置表的字符编码为utf8</li>
<li>设置表的属性值自动增加，默认自增1，关键词：<code>auto_increment</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_emp(<br>    id <span class="hljs-keyword">primary</span> key auto_increment,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>)<br>);<br></code></pre></td></tr></table></figure></li>
<li>Educoder截图<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.1.5.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<h2 id="1-2-数据库和表的基本操作（一）"><a href="#1-2-数据库和表的基本操作（一）" class="headerlink" title="1.2 数据库和表的基本操作（一）"></a>1.2 数据库和表的基本操作（一）</h2><h3 id="1-2-1-查看表结构与修改表名"><a href="#1-2-1-查看表结构与修改表名" class="headerlink" title="1.2.1 查看表结构与修改表名"></a>1.2.1 查看表结构与修改表名</h3><ol>
<li>查看数据表基本结构<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">describe</span> `表名`;<br></code></pre></td></tr></table></figure>
其中，该结构中各个字段的含义分别为：</li>
</ol>
<ul>
<li><code>NULL</code>：表示该列是否能存储 NULL 值；</li>
<li><code>Key</code>：表示该列是否已编制索引；</li>
<li><code>PRI</code>：表示该列是此表主键的一部分；</li>
<li><code>UNI</code>：表示该列是 UNIQUE 索引的一部分；</li>
<li><code>MUL</code>：表示在列中某个给定值允许出现多次；</li>
<li><code>Default</code>：表示该列是否有默认值，如果有的话值是多少；</li>
<li><code>Extra</code>：表示可以获取的与给定列有关的附加信息。</li>
</ul>
<ol start="2">
<li>查看表详细结构：返回建表时的详细语句(<code>\G</code>是可选参数，用以美化输出)<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> `表名` \G;<br></code></pre></td></tr></table></figure></li>
<li>修改表名<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `旧表名` rename `新表名`; <br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp rename jd_emp;<br><span class="hljs-keyword">show</span> tables;<br><span class="hljs-keyword">desc</span> jd_emp;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-2-修改字段名和字段类型"><a href="#1-2-2-修改字段名和字段类型" class="headerlink" title="1.2.2 修改字段名和字段类型"></a>1.2.2 修改字段名和字段类型</h3><ol>
<li>修改字段名<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` change `旧字段名` `新字段名` `新数据类型`;<br></code></pre></td></tr></table></figure></li>
<li>修改字段数据类型<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` modify `字段名` `数据类型`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp change Id prod_id <span class="hljs-type">int</span>(<span class="hljs-number">11</span>);<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp modify Name <span class="hljs-type">varchar</span>(<span class="hljs-number">30</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-3-添加和删除字段"><a href="#1-2-3-添加和删除字段" class="headerlink" title="1.2.3 添加和删除字段"></a>1.2.3 添加和删除字段</h3><ol>
<li>添加字段<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` <span class="hljs-keyword">add</span> `新字段名` `数据类型` `[约束条件]` `[<span class="hljs-keyword">first</span><span class="hljs-operator">|</span>after 已存在字段名]`;<br></code></pre></td></tr></table></figure>
[]中内容为可选参数；默认添加字段在最后一列。<br><code>first</code>：指定在第一列<br><code>after 已存在字段名</code>：指定在该字段后</li>
<li>删除字段<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` <span class="hljs-keyword">drop</span> `字段名`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp <span class="hljs-keyword">add</span> Country <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) after Name;<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp <span class="hljs-keyword">drop</span> Salary;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-4-修改字段排列位置"><a href="#1-2-4-修改字段排列位置" class="headerlink" title="1.2.4 修改字段排列位置"></a>1.2.4 修改字段排列位置</h3><ol>
<li>修改字段排列位置<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` modify `字段<span class="hljs-number">1</span>` `数据类型` <span class="hljs-keyword">first</span> <span class="hljs-operator">|</span> after `字段<span class="hljs-number">2</span>`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp modify Name <span class="hljs-type">varchar</span>(<span class="hljs-number">25</span>) <span class="hljs-keyword">first</span>;<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp modify DeptId <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) after Salary;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-5-删除表外键约束"><a href="#1-2-5-删除表外键约束" class="headerlink" title="1.2.5 删除表外键约束"></a>1.2.5 删除表外键约束</h3><ol>
<li>删除表外键约束<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `表名` <span class="hljs-keyword">drop</span> <span class="hljs-keyword">foreign</span> key `外键约束名`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder 代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> tb_emp <span class="hljs-keyword">drop</span> <span class="hljs-keyword">foreign</span> key emp_dept;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-3-数据库和表的基本操作（二）"><a href="#1-3-数据库和表的基本操作（二）" class="headerlink" title="1.3 数据库和表的基本操作（二）"></a>1.3 数据库和表的基本操作（二）</h2><h3 id="1-3-1-插入数据"><a href="#1-3-1-插入数据" class="headerlink" title="1.3.1 插入数据"></a>1.3.1 插入数据</h3><ol>
<li>为表的所有字段插入数据<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `表名`(`字段名`) <span class="hljs-keyword">values</span>(`内容`);<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tb_emp(Id,Name,DeptId,Salary) <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Nancy&#x27;</span>,<span class="hljs-number">301</span>,<span class="hljs-number">2300.00</span>),(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;Tod&#x27;</span>,<span class="hljs-number">303</span>,<span class="hljs-number">5600.00</span>),(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;Carly&#x27;</span>,<span class="hljs-number">301</span>,<span class="hljs-number">3200.00</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-3-2-更新数据"><a href="#1-3-2-更新数据" class="headerlink" title="1.3.2 更新数据"></a>1.3.2 更新数据</h3><ol>
<li>更新表中指定内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> `表名` <span class="hljs-keyword">set</span> `字段名<span class="hljs-number">1</span>`<span class="hljs-operator">=</span>`内容<span class="hljs-number">1</span>`, `字段名<span class="hljs-number">2</span>`<span class="hljs-operator">=</span>`内容<span class="hljs-number">2</span>`, `字段名<span class="hljs-number">3</span>`<span class="hljs-operator">=</span>`内容<span class="hljs-number">3</span>` <span class="hljs-keyword">where</span> `过滤条件`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> tb_emp<br><span class="hljs-keyword">set</span> Name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Tracy&#x27;</span>,DeptId<span class="hljs-operator">=</span><span class="hljs-number">302</span>,Salary<span class="hljs-operator">=</span><span class="hljs-number">4300.00</span><br><span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-3-3-删除数据"><a href="#1-3-3-删除数据" class="headerlink" title="1.3.3 删除数据"></a>1.3.3 删除数据</h3><ol>
<li>删除表中指定行<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `过滤条件`;<br></code></pre></td></tr></table></figure></li>
<li>删除表中所有行<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> `表名`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> tb_emp<br><span class="hljs-keyword">where</span> salary<span class="hljs-operator">&gt;</span><span class="hljs-number">3000</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-4-单表查询（一）"><a href="#1-4-单表查询（一）" class="headerlink" title="1.4 单表查询（一）"></a>1.4 单表查询（一）</h2><h3 id="1-4-1-基本查询语句"><a href="#1-4-1-基本查询语句" class="headerlink" title="1.4.1 基本查询语句"></a>1.4.1 基本查询语句</h3><ol>
<li>查询数据表中指定字段的内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名`;<br><span class="hljs-keyword">select</span> `字段名<span class="hljs-number">1</span>`,<span class="hljs-string">&#x27;字段名2&#x27;</span> <span class="hljs-keyword">from</span> `表名`;<br></code></pre></td></tr></table></figure></li>
<li>查询数据表中的所有内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> `表名`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Name,Salary <span class="hljs-keyword">FROM</span> tb_emp;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-4-2-带IN关键字的查询"><a href="#1-4-2-带IN关键字的查询" class="headerlink" title="1.4.2 带IN关键字的查询"></a>1.4.2 带IN关键字的查询</h3><ol>
<li>带in关键字的查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">in</span> (`n1`, `n2`, `n3`);<br></code></pre></td></tr></table></figure>
括号里的内容必须为int类型</li>
<li>带 not in关键字的查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (`n1`, `n2`, `n3`);<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Name,Salary <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-4-3-带between-and-的关键字查询"><a href="#1-4-3-带between-and-的关键字查询" class="headerlink" title="1.4.3 带between and 的关键字查询"></a>1.4.3 带between and 的关键字查询</h3><ol>
<li>带between and关键字的查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">between</span> `n1` <span class="hljs-keyword">and</span> `n2`;<br></code></pre></td></tr></table></figure></li>
<li>带not between and关键字的查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">not</span> <span class="hljs-keyword">between</span> `n1` <span class="hljs-keyword">and</span> `n2`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder 代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Name,Salary <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> Salary <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">3000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">5000</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-5-单表查询（二）"><a href="#1-5-单表查询（二）" class="headerlink" title="1.5 单表查询（二）"></a>1.5 单表查询（二）</h2><h3 id="1-5-1-带like的字符匹配查询"><a href="#1-5-1-带like的字符匹配查询" class="headerlink" title="1.5.1 带like的字符匹配查询"></a>1.5.1 带like的字符匹配查询</h3><ol>
<li>使用通配符%模糊匹配数据内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;字符%&#x27;</span>;<br></code></pre></td></tr></table></figure>
<code>%</code>匹配任意长度字符</li>
<li>使用通配符_模糊匹配数据内容<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;字符_&#x27;</span>;<br></code></pre></td></tr></table></figure>
<code>_</code>匹配任意长度字符</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Name,Salary <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> Name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;C%&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-5-2-查询空值和去除重复结果"><a href="#1-5-2-查询空值和去除重复结果" class="headerlink" title="1.5.2 查询空值和去除重复结果"></a>1.5.2 查询空值和去除重复结果</h3><ol>
<li>查询空值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span>;<br></code></pre></td></tr></table></figure>
非空值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `字段名` <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>;<br></code></pre></td></tr></table></figure></li>
<li>去除重复结果<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> `字段名` <span class="hljs-keyword">from</span> `表名`<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> DeptId <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> Name <span class="hljs-keyword">FROM</span> tb_emp;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-5-3-带and和or的多条件查询"><a href="#1-5-3-带and和or的多条件查询" class="headerlink" title="1.5.3 带and和or的多条件查询"></a>1.5.3 带and和or的多条件查询</h3><ol>
<li>带and关键字的多条件查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `表达式<span class="hljs-number">1</span>` <span class="hljs-keyword">and</span> `表达式<span class="hljs-number">2</span>`;<br></code></pre></td></tr></table></figure></li>
<li>带or关键字的多条件查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">where</span> `表达式<span class="hljs-number">1</span>` <span class="hljs-keyword">or</span> `表达式<span class="hljs-number">2</span>`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> DeptId<span class="hljs-operator">=</span><span class="hljs-number">301</span> <span class="hljs-keyword">AND</span> Salary<span class="hljs-operator">&gt;</span><span class="hljs-number">3000</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> tb_emp <span class="hljs-keyword">WHERE</span> DeptId <span class="hljs-keyword">in</span> (<span class="hljs-number">301</span>,<span class="hljs-number">303</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-6-单表查询（三）"><a href="#1-6-单表查询（三）" class="headerlink" title="1.6 单表查询（三）"></a>1.6 单表查询（三）</h2><h3 id="1-6-1-对查询结果进行排序"><a href="#1-6-1-对查询结果进行排序" class="headerlink" title="1.6.1 对查询结果进行排序"></a>1.6.1 对查询结果进行排序</h3><ol>
<li>对查询结果排序<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> `字段名` [<span class="hljs-keyword">asc</span><span class="hljs-operator">|</span><span class="hljs-keyword">desc</span>]<br></code></pre></td></tr></table></figure>
<code>asc</code>和<code>desc</code>关键字对应生升序还是降序，默认为升序。</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> tb_score <span class="hljs-keyword">WHERE</span> class_id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-6-2-分组查询"><a href="#1-6-2-分组查询" class="headerlink" title="1.6.2 分组查询"></a>1.6.2 分组查询</h3><ol>
<li>分组查询的单独使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> `字段名`;<br></code></pre></td></tr></table></figure>
查询每个分组值中第一次出现的记录</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">FROM</span> tb_class<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> class_id;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-6-3-使用limit限制查询结果的数量"><a href="#1-6-3-使用limit限制查询结果的数量" class="headerlink" title="1.6.3 使用limit限制查询结果的数量"></a>1.6.3 使用limit限制查询结果的数量</h3><ol>
<li>limit的使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> `字段名` <span class="hljs-keyword">from</span> `表名` limit [offest, ] `记录数`;<br></code></pre></td></tr></table></figure>
<code>offest</code>：偏移量（默认从0开始）<br><code>记录数</code>：返回多少查询结果的条数</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">FROM</span> tb_score<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> score <span class="hljs-keyword">DESC</span><br>LIMIT <span class="hljs-number">1</span>,<span class="hljs-number">4</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-7-连接查询"><a href="#1-7-连接查询" class="headerlink" title="1.7 连接查询"></a>1.7 连接查询</h2><h3 id="1-7-1-内连接查询"><a href="#1-7-1-内连接查询" class="headerlink" title="1.7.1 内连接查询"></a>1.7.1 内连接查询</h3><ol>
<li>内连接查询<br>将两个表中满足连接条件的行组合起来作为结果集<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">`表<span class="hljs-number">1</span>` [<span class="hljs-keyword">inner</span>] <span class="hljs-keyword">join</span> `表<span class="hljs-number">2</span>` <span class="hljs-keyword">on</span> `表<span class="hljs-number">1</span>`.`字段`<span class="hljs-operator">=</span>`表<span class="hljs-number">2</span>`.`字段`<br></code></pre></td></tr></table></figure></li>
<li>Educoder上的例子<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.7.1.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> tb_student.name <span class="hljs-keyword">AS</span> studentName,tb_class.name <span class="hljs-keyword">AS</span> className <br><span class="hljs-keyword">FROM</span> tb_student <span class="hljs-keyword">join</span> tb_class<br><span class="hljs-keyword">ON</span> tb_student.class_id <span class="hljs-operator">=</span> tb_class.id;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-7-2-外连接查询"><a href="#1-7-2-外连接查询" class="headerlink" title="1.7.2 外连接查询"></a>1.7.2 外连接查询</h3><ol>
<li>外连接查询<br>以某张表为主，取出所有内容，然后和另一张表进行连接。不满足条件的行对应字段内容为null<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">`表<span class="hljs-number">1</span>` <span class="hljs-keyword">left</span><span class="hljs-operator">/</span><span class="hljs-keyword">right</span> [<span class="hljs-keyword">outer</span>] <span class="hljs-keyword">join</span> `表<span class="hljs-number">2</span>` <span class="hljs-keyword">on</span> `表<span class="hljs-number">1</span>`.`字段`<span class="hljs-operator">=</span>`表<span class="hljs-number">2</span>`.`字段`<br></code></pre></td></tr></table></figure>
<code>left</code>：以左为主；<code>right</code>：以右为主。</li>
<li>Educoder上的例子<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.7.2.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> tb_student.name <span class="hljs-keyword">AS</span> studentName,tb_class.name <span class="hljs-keyword">AS</span> className<br><span class="hljs-keyword">FROM</span> tb_student <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> tb_class<br><span class="hljs-keyword">ON</span> tb_student.class_id <span class="hljs-operator">=</span> tb_class.id;<br><span class="hljs-keyword">SELECT</span> tb_student.name <span class="hljs-keyword">AS</span> studentName,tb_class.name <span class="hljs-keyword">AS</span> className<br><span class="hljs-keyword">FROM</span> tb_student <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> tb_class<br><span class="hljs-keyword">ON</span> tb_student.class_id <span class="hljs-operator">=</span> tb_class.id;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-7-3-复合条件连接查询"><a href="#1-7-3-复合条件连接查询" class="headerlink" title="1.7.3 复合条件连接查询"></a>1.7.3 复合条件连接查询</h3><ol>
<li>复合条件连接查询<br>在连接查询过程中添加过滤条件</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> tb_student.name <span class="hljs-keyword">AS</span> studentName,tb_student.score,tb_class.name <span class="hljs-keyword">AS</span> className<br><span class="hljs-keyword">FROM</span> tb_student <span class="hljs-keyword">JOIN</span> tb_class<br><span class="hljs-keyword">ON</span> tb_student.class_id <span class="hljs-operator">=</span> tb_class.id<br><span class="hljs-keyword">WHERE</span> score <span class="hljs-operator">&gt;</span> <span class="hljs-number">90</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-8-子查询"><a href="#1-8-子查询" class="headerlink" title="1.8 子查询"></a>1.8 子查询</h2><h3 id="1-8-1-带比较运算符的子查询"><a href="#1-8-1-带比较运算符的子查询" class="headerlink" title="1.8.1 带比较运算符的子查询"></a>1.8.1 带比较运算符的子查询</h3><ol>
<li><p>子查询<br>子查询是指出现在其他SQL语句内的select子句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">where</span> col1<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> col2 <span class="hljs-keyword">from</span> t2);<br></code></pre></td></tr></table></figure>
</li>
<li><p>带比较运算符的子查询<br>各种比较运算符</p>
</li>
<li><p>Educoder代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> name,age <br><span class="hljs-keyword">FROM</span> tb_emp<br><span class="hljs-keyword">WHERE</span> age<span class="hljs-operator">&gt;</span>(<br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(age)<br><span class="hljs-keyword">FROM</span> tb_emp<br>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-8-2-关键字查询"><a href="#1-8-2-关键字查询" class="headerlink" title="1.8.2 关键字查询"></a>1.8.2 关键字查询</h3><ol>
<li><p><code>ALL</code>关键字<br><code>ALL</code>必须接在一个比较运算符的后面，表示与子查询返回的所有值比较都为<code>TRUE</code>则返回<code>TRUE</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> col1 <span class="hljs-keyword">from</span> table1 <span class="hljs-keyword">where</span> col1 <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">all</span> (<span class="hljs-keyword">select</span> col2 <span class="hljs-keyword">from</span> table2) <br></code></pre></td></tr></table></figure></li>
<li><p><code>ANY</code>和<code>SOME</code>关键字<br><code>ANY</code>与比较操作符联合使用，表示与子查询返回的任何值比较为<code>TRUE</code>，则返回<code>TRUE</code>。<br><code>SOME</code>是<code>ANY</code>的别名，一般用的比较少。</p>
</li>
<li><p><code>IN</code>关键字<br><code>IN</code>的意思就是指定的一个值是否在这个集合中，如果在就返回<code>TRUE</code>；否则就返回<code>FALSE</code>了，同<code>IN(项1，项2，...)</code>；<br><code>IN</code>是<code>= ANY</code>的别名，二者相同，但<code>NOT IN</code>的别名却不是<code>&lt;&gt; ANY</code>而是<code>&lt;&gt; SOME</code></p>
</li>
<li><p>Educoder代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> position, salary<br><span class="hljs-keyword">from</span> tb_salary<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">all</span>(<br>    <span class="hljs-keyword">select</span> salary<br>    <span class="hljs-keyword">from</span> tb_salary<br>    <span class="hljs-keyword">where</span> position<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Java&#x27;</span><br>);<br><br><span class="hljs-keyword">select</span> position, salary<br><span class="hljs-keyword">from</span> tb_salary<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">any</span>(<br>    <span class="hljs-keyword">select</span> salary<br>    <span class="hljs-keyword">from</span> tb_salary<br>    <span class="hljs-keyword">where</span> position<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Java&#x27;</span><br>);<br><br><span class="hljs-keyword">select</span> position, salary<br><span class="hljs-keyword">from</span> tb_salary<br><span class="hljs-keyword">where</span> position<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Java&#x27;</span>;<br><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-9-复杂查询（一）"><a href="#1-9-复杂查询（一）" class="headerlink" title="1.9 复杂查询（一）"></a>1.9 复杂查询（一）</h2><h3 id="1-9-1-交换工资"><a href="#1-9-1-交换工资" class="headerlink" title="1.9.1 交换工资"></a>1.9.1 交换工资</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.9.1.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> tb_Salary <span class="hljs-keyword">set</span> sex<span class="hljs-operator">=</span>(<br>    if(sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>)<br>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-9-2-换座位"><a href="#1-9-2-换座位" class="headerlink" title="1.9.2 换座位"></a>1.9.2 换座位</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.9.2.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> if(id<span class="hljs-operator">%</span><span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">0</span>, id<span class="hljs-number">-1</span>, if(id<span class="hljs-operator">=</span><span class="hljs-number">5</span>,id,id<span class="hljs-operator">+</span><span class="hljs-number">1</span>)) <span class="hljs-keyword">as</span> id, name<br><span class="hljs-keyword">from</span> tb_Seat<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> id;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-9-3-分数排名"><a href="#1-9-3-分数排名" class="headerlink" title="1.9.3 分数排名"></a>1.9.3 分数排名</h3><ol>
<li><p>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.9.3.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>Educoder代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> Score, (<br>    <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-keyword">distinct</span> Score)<br>    <span class="hljs-keyword">from</span> score<br>    <span class="hljs-keyword">where</span> score<span class="hljs-operator">&gt;=</span>s.score<br>) <span class="hljs-keyword">as</span> Rank <br><span class="hljs-keyword">from</span> score s<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> Score <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-keyword">select</span> Score, (<br>    <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(Score)<span class="hljs-operator">+</span><span class="hljs-number">1</span><br>    <span class="hljs-keyword">from</span> score<br>    <span class="hljs-keyword">where</span> score<span class="hljs-operator">&gt;</span>s.score<br>) <span class="hljs-keyword">as</span> Rank<br><span class="hljs-keyword">from</span> score s<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> Score <span class="hljs-keyword">desc</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-9-4-体育馆的人流量"><a href="#1-9-4-体育馆的人流量" class="headerlink" title="1.9.4 体育馆的人流量"></a>1.9.4 体育馆的人流量</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.9.4.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> g1.id, g1.date, g1.visitors_flow<br><span class="hljs-keyword">FROM</span> gymnasium g1<br><span class="hljs-keyword">WHERE</span> <br>    (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)<br>     <span class="hljs-keyword">FROM</span> gymnasium g2<br>     <span class="hljs-keyword">WHERE</span> g2.id <span class="hljs-keyword">BETWEEN</span> g1.id<span class="hljs-number">-2</span> <span class="hljs-keyword">AND</span> g1.id<br>     <span class="hljs-keyword">AND</span> g2.visitors_flow <span class="hljs-operator">&gt;=</span> <span class="hljs-number">100</span>) <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br><span class="hljs-keyword">OR</span><br>    (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)<br>     <span class="hljs-keyword">FROM</span> gymnasium g3<br>     <span class="hljs-keyword">WHERE</span> g3.id <span class="hljs-keyword">BETWEEN</span> g1.id<span class="hljs-number">-1</span> <span class="hljs-keyword">AND</span> g1.id<span class="hljs-operator">+</span><span class="hljs-number">1</span><br>     <span class="hljs-keyword">AND</span> g3.visitors_flow <span class="hljs-operator">&gt;=</span> <span class="hljs-number">100</span>) <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br><span class="hljs-keyword">OR</span><br>    (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)<br>     <span class="hljs-keyword">FROM</span> gymnasium g4<br>     <span class="hljs-keyword">WHERE</span> g4.id <span class="hljs-keyword">BETWEEN</span> g1.id <span class="hljs-keyword">AND</span> g1.id<span class="hljs-operator">+</span><span class="hljs-number">2</span><br>     <span class="hljs-keyword">AND</span> g4.visitors_flow <span class="hljs-operator">&gt;=</span> <span class="hljs-number">100</span>) <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-9-5-统计总成绩"><a href="#1-9-5-统计总成绩" class="headerlink" title="1.9.5 统计总成绩"></a>1.9.5 统计总成绩</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.9.5.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <br>    c.classname,<br>    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> s.chinese <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">THEN</span> s.chinese <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> chinese,<br>    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> s.maths <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">THEN</span> s.maths <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> maths<br><span class="hljs-keyword">FROM</span> <br>    tb_score s<br><span class="hljs-keyword">JOIN</span> <br>    tb_class c <span class="hljs-keyword">ON</span> s.name <span class="hljs-operator">=</span> c.stuname<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <br>    c.classname;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-10-复杂查询（二）"><a href="#1-10-复杂查询（二）" class="headerlink" title="1.10 复杂查询（二）"></a>1.10 复杂查询（二）</h2><h3 id="1-10-1-查询学生平均分"><a href="#1-10-1-查询学生平均分" class="headerlink" title="1.10.1 查询学生平均分"></a>1.10.1 查询学生平均分</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.10.1.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> stu.s_id,stu.s_name,round(<span class="hljs-built_in">avg</span>(if(sco.s_score <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span>,<span class="hljs-number">0.00</span>, sco.s_score)),<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> avg_score<br><span class="hljs-keyword">from</span> student stu <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> score sco<br><span class="hljs-keyword">on</span> stu.s_id<span class="hljs-operator">=</span>sco.s_id<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> stu.s_id,stu.s_name<br><span class="hljs-keyword">having</span> avg_score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-10-2-查询修课相同学生信息"><a href="#1-10-2-查询修课相同学生信息" class="headerlink" title="1.10.2 查询修课相同学生信息"></a>1.10.2 查询修课相同学生信息</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.10.2.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> s_id,s_name,s_sex<br><span class="hljs-keyword">from</span> student<br><span class="hljs-keyword">where</span> s_id <span class="hljs-keyword">in</span> (<br>    <span class="hljs-keyword">select</span> s_id <span class="hljs-keyword">from</span> score<br>    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> s_id<br>    <span class="hljs-keyword">having</span> s_id<span class="hljs-operator">!=</span><span class="hljs-string">&#x27;01&#x27;</span> <span class="hljs-keyword">and</span> <br>    group_concat(c_id <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> c_id)<br>    <span class="hljs-operator">=</span>(<br>        <span class="hljs-keyword">select</span> group_concat(c_id <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> c_id) <span class="hljs-keyword">as</span> str2<br>        <span class="hljs-keyword">from</span> score<br>        <span class="hljs-keyword">where</span> s_id<span class="hljs-operator">=</span><span class="hljs-string">&#x27;01&#x27;</span><br>    )<br>)<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-10-3-查询各科成绩并排序"><a href="#1-10-3-查询各科成绩并排序" class="headerlink" title="1.10.3 查询各科成绩并排序"></a>1.10.3 查询各科成绩并排序</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.10.3.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> a.<span class="hljs-operator">*</span> ,<span class="hljs-built_in">count</span>(b.s_score)<span class="hljs-operator">+</span><span class="hljs-number">1</span> rank <span class="hljs-keyword">from</span> score a <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> score b <span class="hljs-keyword">on</span> a.c_id <span class="hljs-operator">=</span> b.c_id <span class="hljs-keyword">and</span> a.s_score <span class="hljs-operator">&lt;</span> b.s_score<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a.c_id,a.s_id<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> a.s_id,a.c_id,a.s_score,<span class="hljs-built_in">count</span>(b.s_score);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-10-4-查询张老师课程成绩最高的学生信息"><a href="#1-10-4-查询张老师课程成绩最高的学生信息" class="headerlink" title="1.10.4 查询张老师课程成绩最高的学生信息"></a>1.10.4 查询张老师课程成绩最高的学生信息</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.10.4.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> s.s_id,st.s_name,st.s_sex,s.s_score,c.c_id,c.c_name <span class="hljs-keyword">from</span>  student st,course c<br><span class="hljs-keyword">join</span> score s<br><span class="hljs-keyword">on</span> c.c_id <span class="hljs-operator">=</span> s.c_id<br><span class="hljs-keyword">where</span> t_id <span class="hljs-operator">=</span>(<br><span class="hljs-keyword">select</span> t_id <span class="hljs-keyword">from</span> teacher<br><span class="hljs-keyword">where</span> t_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张三&#x27;</span>) <span class="hljs-keyword">having</span> <span class="hljs-built_in">max</span>(s.s_score) <br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-10-5-查询两门课程不及格同学信息"><a href="#1-10-5-查询两门课程不及格同学信息" class="headerlink" title="1.10.5 查询两门课程不及格同学信息"></a>1.10.5 查询两门课程不及格同学信息</h3><ol>
<li>任务描述<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.10.5.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> stu.s_id,stu.s_name,round(<span class="hljs-built_in">avg</span>(s_score),<span class="hljs-number">0</span>) avg_score<br><span class="hljs-keyword">from</span> student stu <span class="hljs-keyword">join</span> score sco <span class="hljs-keyword">on</span> stu.s_id<span class="hljs-operator">=</span>sco.s_id<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> stu.s_id<br><span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> s_score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span> <span class="hljs-keyword">then</span> <span class="hljs-number">1</span> <span class="hljs-keyword">end</span>)<span class="hljs-operator">&gt;=</span><span class="hljs-number">2</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-11-使用聚合函数查询"><a href="#1-11-使用聚合函数查询" class="headerlink" title="1.11 使用聚合函数查询"></a>1.11 使用聚合函数查询</h2><h3 id="1-11-1-COUNT-函数"><a href="#1-11-1-COUNT-函数" class="headerlink" title="1.11.1 COUNT()函数"></a>1.11.1 COUNT()函数</h3><ol>
<li>count()函数的基本使用<br>统计记录的总条数<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span><span class="hljs-operator">/</span>`字段名`) <span class="hljs-keyword">from</span> `数据表`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> tb_class;<br><span class="hljs-keyword">select</span> classid, <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> classid<span class="hljs-operator">=</span><span class="hljs-number">367</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-11-2-SUM-函数"><a href="#1-11-2-SUM-函数" class="headerlink" title="1.11.2 SUM()函数"></a>1.11.2 SUM()函数</h3><ol>
<li>sum()函数的基本使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(`字段名`) <span class="hljs-keyword">from</span> `数据表`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(score) <span class="hljs-keyword">from</span> tb_class;<br><span class="hljs-keyword">select</span> course,<span class="hljs-built_in">sum</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;语文&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-11-3-AVG函数"><a href="#1-11-3-AVG函数" class="headerlink" title="1.11.3 AVG函数"></a>1.11.3 AVG函数</h3><ol>
<li>avg()函数的基本使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(`字段名`) <span class="hljs-keyword">from</span> `数据表`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">avg</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;语文&#x27;</span>;<br><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">avg</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;英语&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-11-4-MAX-函数"><a href="#1-11-4-MAX-函数" class="headerlink" title="1.11.4 MAX()函数"></a>1.11.4 MAX()函数</h3><ol>
<li>max()函数的基本使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(`字段名`) <span class="hljs-keyword">from</span> `数据表`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">max</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;语文&#x27;</span>;<br><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">max</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;英语&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-11-4-MIN-函数"><a href="#1-11-4-MIN-函数" class="headerlink" title="1.11.4 MIN()函数"></a>1.11.4 MIN()函数</h3><ol>
<li>min()函数的基本使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(`字段名`) <span class="hljs-keyword">from</span> `数据表`;<br></code></pre></td></tr></table></figure></li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">min</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;语文&#x27;</span>;<br><span class="hljs-keyword">select</span> course, <span class="hljs-built_in">min</span>(score) <span class="hljs-keyword">from</span> tb_class <span class="hljs-keyword">where</span> course<span class="hljs-operator">=</span><span class="hljs-string">&#x27;英语&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-12-其他函数的使用"><a href="#1-12-其他函数的使用" class="headerlink" title="1.12 其他函数的使用"></a>1.12 其他函数的使用</h2><h3 id="1-12-1-字符函数"><a href="#1-12-1-字符函数" class="headerlink" title="1.12.1 字符函数"></a>1.12.1 字符函数</h3><ol>
<li><p>常用字符函数</p>
<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>concat()</code></td>
<td align="center">字符串的拼接</td>
</tr>
<tr>
<td align="center"><code>concat_ws()</code></td>
<td align="center">使用指定的字符将目标字符串进行拼接</td>
</tr>
<tr>
<td align="center"><code>format()</code></td>
<td align="center">数字格式化</td>
</tr>
<tr>
<td align="center"><code>lower()</code></td>
<td align="center">字符串全部转换为小写</td>
</tr>
<tr>
<td align="center"><code>upper()</code></td>
<td align="center">字符串全部转换为大写</td>
</tr>
<tr>
<td align="center"><code>left()</code></td>
<td align="center">获取左侧的字符串</td>
</tr>
<tr>
<td align="center"><code>right()</code></td>
<td align="center">获取右侧的字符串</td>
</tr>
<tr>
<td align="center"><code>length()</code></td>
<td align="center">计算字符串的长度</td>
</tr>
<tr>
<td align="center"><code>ltrim()</code></td>
<td align="center">删除前导的空格</td>
</tr>
<tr>
<td align="center"><code>rtrim()</code></td>
<td align="center">删除后续的空格</td>
</tr>
<tr>
<td align="center"><code>trim()</code></td>
<td align="center">删除前导和后续的空格</td>
</tr>
<tr>
<td align="center"><code>substring()</code></td>
<td align="center">字符串截取</td>
</tr>
<tr>
<td align="center"><code>substring_index()</code></td>
<td align="center">分隔字符串</td>
</tr>
<tr>
<td align="center"><code>replace()</code></td>
<td align="center">字符串替换</td>
</tr>
<tr>
<td align="center"><code>[not] like</code></td>
<td align="center">模式匹配</td>
</tr>
</tbody></table>
</li>
<li><p><code>concat()</code>与<code>concat_ws()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-concat.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-concat_ws.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p><code>left()</code>与<code>right()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-left_right.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p><code>ltrim()</code>、<code>rtrim()</code>与<code>trim()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-trim_1.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-trim_2.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p><code>substring()</code>、<code>substring_index()</code>与<code>replace()</code></p>
</li>
</ol>
<ul>
<li>replace:<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-replace.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-replace_1.png" srcset="/img/loading.gif" lazyload></li>
<li>substring:<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-substring.png" srcset="/img/loading.gif" lazyload></li>
<li>substring_index:<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.1-substring_index.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<ol start="6">
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> concat(<span class="hljs-built_in">upper</span>(<span class="hljs-keyword">left</span>(Name,<span class="hljs-number">1</span>)),<span class="hljs-built_in">lower</span>(<span class="hljs-keyword">right</span>(Name,<span class="hljs-number">2</span>))) <span class="hljs-keyword">as</span> Name <span class="hljs-keyword">from</span> employee;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-12-2-数学函数"><a href="#1-12-2-数学函数" class="headerlink" title="1.12.2 数学函数"></a>1.12.2 数学函数</h3><ol>
<li>数值运算符</li>
</ol>
<ul>
<li>“加减乘除”即常用的数值运算符<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-1.png" srcset="/img/loading.gif" lazyload></li>
<li>运算函数<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>ceil()</code></td>
<td align="center">进一（向上）取整</td>
</tr>
<tr>
<td align="center"><code>floor()</code></td>
<td align="center">舍一（向下）取整</td>
</tr>
<tr>
<td align="center"><code>power()</code></td>
<td align="center">幂运算</td>
</tr>
<tr>
<td align="center"><code>sqrt()</code></td>
<td align="center">平方根运算</td>
</tr>
<tr>
<td align="center"><code>round()</code></td>
<td align="center">四舍五入</td>
</tr>
<tr>
<td align="center"><code>abs()</code></td>
<td align="center">绝对值计算</td>
</tr>
<tr>
<td align="center"><code>rand()</code></td>
<td align="center">生产0-1的随机数</td>
</tr>
<tr>
<td align="center"><code>truncate()</code></td>
<td align="center">数字截取</td>
</tr>
<tr>
<td align="center"><code>div()</code></td>
<td align="center">整数除法</td>
</tr>
<tr>
<td align="center"><code>mod()</code></td>
<td align="center">取余数(取模)</td>
</tr>
</tbody></table>
</li>
<li><code>ceil()</code>和<code>floor()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-2.png" srcset="/img/loading.gif" lazyload></li>
<li><code>div()</code>和<code>mod()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-3.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-4.png" srcset="/img/loading.gif" lazyload></li>
<li><code>round()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-5.png" srcset="/img/loading.gif" lazyload></li>
<li><code>power()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-6.png" srcset="/img/loading.gif" lazyload></li>
<li><code>sqrt()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-7.png" srcset="/img/loading.gif" lazyload></li>
<li><code>truncate()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-8.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<ol start="2">
<li>比较运算符<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>[not] between...and..</code></td>
<td align="center">[不]在范围内</td>
</tr>
<tr>
<td align="center"><code>[not] in()</code></td>
<td align="center">[不]在列出值范围内</td>
</tr>
<tr>
<td align="center"><code>is [not] null</code></td>
<td align="center">[不]为空</td>
</tr>
</tbody></table>
</li>
</ol>
<ul>
<li><code>between...and...</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-9.png" srcset="/img/loading.gif" lazyload></li>
<li><code>in()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-10.png" srcset="/img/loading.gif" lazyload></li>
<li><code>is_null()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.2-11.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<ol start="3">
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> Score <span class="hljs-keyword">set</span> s_score<span class="hljs-operator">=</span><span class="hljs-keyword">truncate</span>(s_score<span class="hljs-operator">-</span>round(<span class="hljs-built_in">sqrt</span>((<span class="hljs-built_in">power</span>(<span class="hljs-number">4</span>,<span class="hljs-number">4</span>)<span class="hljs-operator">-</span><span class="hljs-built_in">power</span>(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>))<span class="hljs-operator">/</span><span class="hljs-built_in">power</span>(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)),<span class="hljs-number">2</span>),<span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-12-3-日期时间函数和流程控制类函数"><a href="#1-12-3-日期时间函数和流程控制类函数" class="headerlink" title="1.12.3 日期时间函数和流程控制类函数"></a>1.12.3 日期时间函数和流程控制类函数</h3><ol>
<li>日期函数<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>now()</code></td>
<td align="center">当前日期和时间</td>
</tr>
<tr>
<td align="center"><code>curdate()</code></td>
<td align="center">当前日期</td>
</tr>
<tr>
<td align="center"><code>curtime()</code></td>
<td align="center">当前时间</td>
</tr>
<tr>
<td align="center"><code>date_add()</code></td>
<td align="center">日期变化</td>
</tr>
<tr>
<td align="center"><code>datediff()</code></td>
<td align="center">日期差值</td>
</tr>
<tr>
<td align="center"><code>date_format()</code></td>
<td align="center">日期格式化</td>
</tr>
<tr>
<td align="center"><code>year()</code></td>
<td align="center">返回日期的年份</td>
</tr>
<tr>
<td align="center"><code>month()</code></td>
<td align="center">返回日期的月份</td>
</tr>
<tr>
<td align="center"><code>week()</code></td>
<td align="center">返回日期的周号</td>
</tr>
</tbody></table>
</li>
</ol>
<ul>
<li><code>now()</code>、<code>curdate()</code>和<code>curtime()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-1.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-2.png" srcset="/img/loading.gif" lazyload></li>
<li><code>date_add()</code>、<code>datediff()</code>和<code>date_format()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-3.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-4.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-5.png" srcset="/img/loading.gif" lazyload><br>format常用说明符<table>
<thead>
<tr>
<th align="center">格式</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>%d</code></td>
<td align="center">月的天，数值（00-31）</td>
</tr>
<tr>
<td align="center"><code>%H</code></td>
<td align="center">小时 （00-23）</td>
</tr>
<tr>
<td align="center"><code>%h</code></td>
<td align="center">小时 （01-12）</td>
</tr>
<tr>
<td align="center"><code>%m</code></td>
<td align="center">月，数值（00-12）</td>
</tr>
<tr>
<td align="center"><code>%p</code></td>
<td align="center">AM 或 PM</td>
</tr>
<tr>
<td align="center"><code>%s</code></td>
<td align="center">秒（00-59）</td>
</tr>
<tr>
<td align="center"><code>%T</code></td>
<td align="center">时间，24-小时（hh:mm:ss）</td>
</tr>
<tr>
<td align="center"><code>%Y</code></td>
<td align="center">年，4 位</td>
</tr>
</tbody></table>
</li>
<li><code>year()</code>和<code>month()</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-6.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<ol start="2">
<li>流程控制类函数<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>if()</code></td>
<td align="center">判断，流程控制</td>
</tr>
<tr>
<td align="center"><code>ifnull()</code></td>
<td align="center">字段值是否为空</td>
</tr>
<tr>
<td align="center"><code>case()</code></td>
<td align="center">搜索语句</td>
</tr>
</tbody></table>
</li>
</ol>
<ul>
<li><code>if()</code>：<code>if(a,b,c)</code>如果<code>a</code>为真返回<code>b</code>，否则返回<code>c</code>;<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-7.png" srcset="/img/loading.gif" lazyload></li>
<li><code>ifnull()</code>：<code>ifnull(a,b)</code>如果<code>a</code>不为<code>null</code>返回<code>a</code>，否则返回<code>b</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-8.png" srcset="/img/loading.gif" lazyload></li>
<li><code>case()</code>：<code>case when a then b end</code>如果<code>a</code>为真返回<code>b</code><br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.12.3-9.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<ol start="3">
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">year</span>(s_birth) <span class="hljs-keyword">as</span> <span class="hljs-keyword">year</span>, (<span class="hljs-keyword">year</span>(<span class="hljs-string">&#x27;2019-01-01&#x27;</span>)<span class="hljs-operator">-</span><span class="hljs-keyword">year</span>(s_birth)) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;年龄&#x27;</span> <span class="hljs-keyword">from</span> Student;<br><br><span class="hljs-keyword">select</span><br>    c.c_id <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;课程id&#x27;</span>, <br>    c.c_name <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;课程名&#x27;</span>,<br>    <span class="hljs-built_in">max</span>(s.s_score) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;最高分&#x27;</span>,<br>    <span class="hljs-built_in">min</span>(s.s_score) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;最低分&#x27;</span>,<br>    round(<span class="hljs-built_in">avg</span>(s.s_score),<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;平均分&#x27;</span>,<br>    round(<span class="hljs-built_in">sum</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> s.s_score<span class="hljs-operator">&gt;=</span><span class="hljs-number">60</span> <span class="hljs-keyword">then</span> <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-keyword">end</span>)<span class="hljs-operator">/</span><span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<span class="hljs-operator">*</span><span class="hljs-number">100</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;及格率&#x27;</span><br><span class="hljs-keyword">from</span><br>    Course c<br><span class="hljs-keyword">join</span><br>    Score s <span class="hljs-keyword">on</span> s.c_id<span class="hljs-operator">=</span>c.c_id<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><br>    c.c_id<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span><br>    c.c_id <span class="hljs-keyword">asc</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-12-4-自定义函数"><a href="#1-12-4-自定义函数" class="headerlink" title="1.12.4 自定义函数"></a>1.12.4 自定义函数</h3><ol>
<li>自定义函数<br>参数：不一定要有<br>返回值：一定要有<br>创建自定义函数:<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">delimiter <span class="hljs-operator">/</span><span class="hljs-operator">/</span> 　#如果函数体只有一条语句, <span class="hljs-keyword">begin</span>和<span class="hljs-keyword">end</span>可以省略, 同时delimiter也可以省略<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> `函数名`(`形参列表`) <span class="hljs-keyword">returns</span> `返回类型` #注意是retruns<br><span class="hljs-keyword">begin</span><br>    `函数体`    #函数内定义的变量如：<span class="hljs-keyword">set</span> <span class="hljs-variable">@x</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; 变量x为全局变量，在函数外面也可以使用<br>    `返回值`<br><span class="hljs-keyword">end</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span><br>delimiter ;<br></code></pre></td></tr></table></figure>
例子：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">delimiter <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> f2(a <span class="hljs-type">int</span>, b <span class="hljs-type">int</span>) <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">int</span><br><span class="hljs-keyword">begin</span><br>    <span class="hljs-keyword">return</span> a <span class="hljs-operator">+</span> b;<br><span class="hljs-keyword">end</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span><br>delimiter ;<br></code></pre></td></tr></table></figure></li>
<li>删除自定义函数<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span> [if <span class="hljs-keyword">exists</span>] function_name;<br></code></pre></td></tr></table></figure></li>
<li>定义全局变量并赋值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> @`用户变量名`<span class="hljs-operator">=</span>`值`;<br><span class="hljs-keyword">set</span> @`用户变量名`:<span class="hljs-operator">=</span>`值`;<br></code></pre></td></tr></table></figure></li>
<li>定义局部变量</li>
</ol>
<ul>
<li>声明<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">declare</span> `变量名` `类型`;<br><span class="hljs-keyword">declare</span> `变量名` `类型` <span class="hljs-keyword">default</span> `值`;<br></code></pre></td></tr></table></figure></li>
<li>赋值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> `变量名`<span class="hljs-operator">=</span>`值`;<br><span class="hljs-keyword">set</span> `变量名`:<span class="hljs-operator">=</span>`值`;<br></code></pre></td></tr></table></figure></li>
</ul>
<ol start="5">
<li>流程控制</li>
</ol>
<ul>
<li><code>if</code>语句<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">IF search_condition <span class="hljs-keyword">THEN</span> statement_list<br>   [ELSEIF search_condition <span class="hljs-keyword">THEN</span> statement_list] ...<br>   [<span class="hljs-keyword">ELSE</span> statement_list]<br><span class="hljs-keyword">END</span> IF;<br></code></pre></td></tr></table></figure></li>
<li><code>case</code>语句</li>
<li><code>where</code>语句<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">[begin_label:] WHILE search_condition DO<br>statement_list<br><span class="hljs-keyword">END</span> WHILE [end_label]<br></code></pre></td></tr></table></figure></li>
</ul>
<ol start="6">
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql">delimiter <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> fn_three_max(param_1 <span class="hljs-type">int</span>, param_2 <span class="hljs-type">int</span>, param_3 <span class="hljs-type">int</span>) <span class="hljs-keyword">returns</span> <span class="hljs-type">int</span><br><span class="hljs-keyword">begin</span><br>    <span class="hljs-keyword">declare</span> max_value <span class="hljs-type">int</span>;<br>    <span class="hljs-keyword">set</span> max_value<span class="hljs-operator">=</span>param_1;<br>    if param_2<span class="hljs-operator">&gt;</span>max_value <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">set</span> max_value<span class="hljs-operator">=</span>param_2;<br>    <span class="hljs-keyword">end</span> if;<br>    if param_3<span class="hljs-operator">&gt;</span>max_value <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">set</span> max_value<span class="hljs-operator">=</span>param_3;<br>    <span class="hljs-keyword">end</span> if;<br>    <span class="hljs-keyword">return</span> max_value;<br><span class="hljs-keyword">end</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span><br>delimiter ;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="1-13-分组选择数据"><a href="#1-13-分组选择数据" class="headerlink" title="1.13 分组选择数据"></a>1.13 分组选择数据</h2><h3 id="1-13-1-GROUP-BY-与聚合函数"><a href="#1-13-1-GROUP-BY-与聚合函数" class="headerlink" title="1.13.1 GROUP BY 与聚合函数"></a>1.13.1 GROUP BY 与聚合函数</h3><ol>
<li>group by与聚合函数的使用<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> [聚合函数] 字段名 <span class="hljs-keyword">from</span> 表名 [<span class="hljs-keyword">where</span> 查询条件]　[<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> 字段名]<br></code></pre></td></tr></table></figure></li>
<li>group by中select指定的字段限制<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> category,<span class="hljs-built_in">sum</span>(count),disgest <span class="hljs-keyword">from</span> info <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> category;<br></code></pre></td></tr></table></figure>
将报错，因为<code>disgest</code>字段既不在聚合函数里面，也不在group函数里面。</li>
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> gradeId,sex,<span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<br><span class="hljs-keyword">from</span> student<br><span class="hljs-keyword">where</span> gradeId <span class="hljs-keyword">in</span>(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>)<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> gradeId,sex;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-13-2-使用HAVING-和-ORDER-BY"><a href="#1-13-2-使用HAVING-和-ORDER-BY" class="headerlink" title="1.13.2 使用HAVING 和 ORDER BY"></a>1.13.2 使用HAVING 和 ORDER BY</h3><ol>
<li>使用having子句进行分组筛选<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> [聚合函数] 字段名 <span class="hljs-keyword">from</span> 表名 [<span class="hljs-keyword">where</span> 查询条件]　[<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> 字段名] [<span class="hljs-keyword">having</span> 字段名 筛选条件]<br></code></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>Having与Where的区别<br>  where子句都可以用having代替，区别在于where过滤行，having过滤分组；</p>
<ul>
<li><p>where子句的作用是在对查询结果进行分组前，将不符合where条件的行去掉，即在分组之前过滤数据，where条件中不能包含聚组函数，使用where条件过滤出特定的行；</p>
</li>
<li><p>having子句的作用是筛选满足条件的组，即在分组之后过滤数据，条件中经常包含聚组函数，使用having条件过滤出特定的组，也可以使用多个分组标准进行分组。</p>
</li>
</ul>
</li>
</ul>
<p><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.13.2-1.png" srcset="/img/loading.gif" lazyload><br>2. Group by和Order by</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> [聚合函数] 字段名 <span class="hljs-keyword">from</span> 表名 [<span class="hljs-keyword">where</span> 查询条件]　[<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> 字段名] [<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 字段名 排序方向]<br></code></pre></td></tr></table></figure>
<p>示例：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.13.2-2.png" srcset="/img/loading.gif" lazyload><br>若分组字段和排序字段一样时，可不需要<code>order by</code>关键字，则只需告知排序方向，即可简写成：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/1.13.2-3.png" srcset="/img/loading.gif" lazyload><br>3. Educoder 代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> sno,<span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<br><span class="hljs-keyword">from</span> tb_grade<br><span class="hljs-keyword">where</span> score<span class="hljs-operator">&gt;=</span><span class="hljs-number">90</span><br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> sno<br><span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<span class="hljs-operator">&gt;=</span><span class="hljs-number">2</span>;<br><br><span class="hljs-keyword">select</span> sno,<span class="hljs-built_in">avg</span>(score)<br><span class="hljs-keyword">from</span> tb_grade<br><span class="hljs-keyword">where</span> sno <span class="hljs-keyword">in</span>(<br>    <span class="hljs-keyword">select</span> sno<br>    <span class="hljs-keyword">from</span> tb_grade<br>    <span class="hljs-keyword">where</span> pno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;语文&#x27;</span> <span class="hljs-keyword">and</span> score<span class="hljs-operator">&gt;=</span><span class="hljs-number">95</span><br><br><br><br>)<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> sno<br><span class="hljs-keyword">having</span> <span class="hljs-built_in">avg</span>(score)<span class="hljs-operator">&gt;=</span><span class="hljs-number">90</span>;<br></code></pre></td></tr></table></figure>

<h1 id="2-MySQL数据管理技术实战"><a href="#2-MySQL数据管理技术实战" class="headerlink" title="2. MySQL数据管理技术实战"></a>2. MySQL数据管理技术实战</h1><h2 id="2-1-视图"><a href="#2-1-视图" class="headerlink" title="2.1 视图"></a>2.1 视图</h2><h3 id="2-1-1-视图"><a href="#2-1-1-视图" class="headerlink" title="2.1.1 视图"></a>2.1.1 视图</h3><ol>
<li>视图的定义<blockquote>
<p>视图（view）是一种虚拟存在的表，是一个逻辑表，本身并不包含数据。通过视图，可以展现基表（用来创建视图的表）的部分数据；视图数据来自定义视图的查询表。</p>
</blockquote>
</li>
<li>创建视图<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">OR</span> REPLACE] [ALGORITHM <span class="hljs-operator">=</span> &#123;UNDEFINED <span class="hljs-operator">|</span> <span class="hljs-keyword">MERGE</span> <span class="hljs-operator">|</span> TEMPTABLE&#125;]<br>    <span class="hljs-keyword">VIEW</span> view_name [(column_list)]<br>    <span class="hljs-keyword">AS</span> select_statement<br>   [<span class="hljs-keyword">WITH</span> [<span class="hljs-keyword">CASCADED</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">LOCAL</span>] <span class="hljs-keyword">CHECK</span> OPTION]<br></code></pre></td></tr></table></figure>
参数说明：</li>
</ol>
<ul>
<li><p><code>OR REPLACE</code>：表示替换已有视图；</p>
</li>
<li><p><code>ALGORITHM</code>：表示视图选择算法，默认算法是<code>UNDEFINED</code>(未定义的)： MySQL 自动选择要使用的算法 ；<code>merge</code>合并；<code>temptable</code>临时表；</p>
</li>
<li><p><code>column_list</code>：可选参数，指定视图中各个属性的名词，默认情况下与<code>select</code>语句中查询的属性相同；</p>
</li>
<li><p><code>select_statement</code>：表示<code>select</code>语句；</p>
</li>
<li><p><code>[WITH [CASCADED | LOCAL] CHECK OPTION]</code>：表示视图在更新时保证在视图的权限范围之内；<code>cascade</code>是默认值，表示更新视图的时候，要满足视图和表的相关条件；<code>local</code>表示更新视图的时候，要满足该视图定义的一个条件即可。</p>
</li>
</ul>
<p>示例1：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.1.1-1.png" srcset="/img/loading.gif" lazyload><br>示例2：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.1.1-2.png" srcset="/img/loading.gif" lazyload><br>以上两个示例可以看出，虽然两个视图的字段名不同，但是，数据是相同的，因为两个视图引用的是同一个表中的数据，并且，<code>as</code>后的创建视图的语句也相同。</p>
<p>在实际开发中，用户可以根据自己的需求，通过视图的方式，获取基本表中自己需要的数据，这样既能满足用户的需求，也不会破坏基本表原来的结构，从而保证了基本表中数据的安全性。</p>
<ol start="3">
<li>操作视图<br>视图是逻辑表，也就是说视图不是真实的表，但操作视图和操作普通表的语法是一样的。</li>
</ol>
<p>用户可以在视图中无条件地使用<code>select</code>语句查询数据。但使用<code>insert</code>、<code>update</code>和<code>delete</code>操作需要在创建视图时满足以下条件（满足以下条件的视图称为可更新视图）：</p>
<ul>
<li><p><code>from</code>子句中只能引用有1个表（真实表或可更新视图）；</p>
</li>
<li><p>不能包含 <code>with</code>、<code>distinct</code>、<code>group by</code>、<code>having</code>、<code>limit</code>等子句；</p>
</li>
<li><p>不能使用复合查询，即不能使用<code>union</code>、<code>intersect</code>、<code>except</code>等集合操作；</p>
</li>
<li><p><code>select</code>子句的字段列表不能包含聚合、窗口函数、集合返回函数。</p>
</li>
</ul>
<p>我们仍使用之前示例中的数据来操作视图：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.1.1-3.png" srcset="/img/loading.gif" lazyload><br>4. 删除视图<br>若视图不再被需要，我们可以将其删除，且视图的删除并不影响源表中的数据。</p>
<p>删除视图的 SQL 如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">VIEW</span> view_name;<br></code></pre></td></tr></table></figure>
<p>示例：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.1.1-4.png" srcset="/img/loading.gif" lazyload></p>
<ol start="5">
<li>Educoder代码<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">#<span class="hljs-number">1.</span>创建单表视图<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> stu_view <span class="hljs-keyword">as</span><br><span class="hljs-keyword">select</span> math,chinese,math<span class="hljs-operator">+</span>chinese<br><span class="hljs-keyword">from</span> student;<br><br>#<span class="hljs-number">2.</span>创建多表视图<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> stu_classes <span class="hljs-keyword">as</span><br><span class="hljs-keyword">select</span> student.stu_id,student.name,stu_info.classes<br><span class="hljs-keyword">from</span> student <span class="hljs-keyword">join</span> stu_info<br><span class="hljs-keyword">on</span> student.stu_id<span class="hljs-operator">=</span>stu_info.stu_id;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-2-索引"><a href="#2-2-索引" class="headerlink" title="2.2 索引"></a>2.2 索引</h2><h3 id="2-2-1-索引"><a href="#2-2-1-索引" class="headerlink" title="2.2.1 索引"></a>2.2.1 索引</h3><ol>
<li><p>索引是什么<br>数据库索引是一种提高数据库系统性能的方法。索引能让数据库服务器更快地查找和获取表中指定的行。<br>例如，为了方便读者快速查找书中的术语，很多书籍在最后附加了索引页，术语按字母排序，同时给出页码。这样读者可以根据术语名，快速获取页码，而不用翻阅整本书。<br>但是索引也给数据库系统带来了一定的开销，所以我们应该谨慎地使用它们。<br>例如现在有一张简单的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> test<br>(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    content <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span><br>)<br></code></pre></td></tr></table></figure>
<p>在这张表中假设存了1000条数据（id依次递增且不重复），我们要查询表中id&#x3D;234的数据，sql如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">234</span>;<br></code></pre></td></tr></table></figure>
<p>一般情况，在没有索引下，数据库系统必须扫描整个表（一行一行地检查），才能获取到所有满足条件的行，很明显这种方法的效率是非常低的。<br>那么肯定有优化的方法，就是 索引 了！在id字段上添加索引，这样 MySQL 就只需要扫描一行数据就可以了。</p>
</li>
<li><p>索引的分类<br>索引大体可分为单列索引（普通索引，唯一索引，主键索引）、组合索引、全文索引、空间索引四类。本实训我们主要介绍单例索引和组合索引：</p>
</li>
</ol>
<ul>
<li>单例索引：一个索引只包含单个列，但一个表中可以有多个单列索引；<ul>
<li>普通索引：仅加速查询 最基本的索引，没有任何限制，是我们大多数情况下使用到的索引；</li>
<li>唯一索引：索引列中的值必须是唯一的，但允许为空值；</li>
<li>主键索引：是一种特殊的唯一索引，不允许有空值。</li>
</ul>
</li>
<li>组合索引：在表的多个字段上创建的索引，只有在查询条件中使用了这些字段的左边字段时，索引才会被使用，使用组合索引时遵循最左前缀集合。</li>
</ul>
<ol start="3">
<li>索引的创建和删除<br><strong>创建索引</strong><br>创建索引有两种方式，一种是在建表时创建，另一种是建表后创建：</li>
</ol>
<ul>
<li><p>普通索引：</p>
<ol>
<li>创表时创建普通索引： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">table</span> mytable(<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">16</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    INDEX [indexName] (username)<br>);<br></code></pre></td></tr></table></figure></li>
<li>建表后创建普通索引：</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> INDEX 索引名称 <span class="hljs-keyword">on</span> 表名(字段名);<br>#或者<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> 表名 <span class="hljs-keyword">ADD</span> INDEX 索引名称 (字段名);<br></code></pre></td></tr></table></figure></li>
<li><p>唯一索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX 索引名称 <span class="hljs-keyword">ON</span> 表名(字段名);<br>#或者<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> 表名 <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">UNIQUE</span> (字段名);<br></code></pre></td></tr></table></figure></li>
<li><p>主键索引：主键索引一般在建表时创建，会设为<code>int</code>而且是<code>AUTO_INCREMENT</code>自增类型的，例如一般表的<code>id</code>字段。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> mytable (<br>  id <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,<br>  <span class="hljs-keyword">PRIMARY</span> KEY (id)<br>);<br></code></pre></td></tr></table></figure></li>
<li><p>组合索引：组合索引就是在多个字段上创建一个索引。（应用场景：当表的行数远远大于索引键的数目时，使用这种方式可以明显加快表的查询速度）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> INDEX 索引名称 <span class="hljs-keyword">ON</span> 表名(字段<span class="hljs-number">1</span>,字段<span class="hljs-number">2</span>，字段<span class="hljs-number">3</span>);<br>#或者<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> 表名 <span class="hljs-keyword">ADD</span> INDEX 索引名称(字段<span class="hljs-number">1</span>，字段<span class="hljs-number">2</span>，字段<span class="hljs-number">3</span>);<br></code></pre></td></tr></table></figure>
<p><strong>删除索引</strong><br>同样，删除索引也有两种方式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">#使用<span class="hljs-keyword">drop</span>删除索引<br><span class="hljs-keyword">drop</span> index index_name <span class="hljs-keyword">on</span> table_name ;<br>#使用<span class="hljs-keyword">alter</span>删除索引<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">drop</span> index index_name ;<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> table_name <span class="hljs-keyword">drop</span> <span class="hljs-keyword">primary</span> key ; #删除主键索引<br></code></pre></td></tr></table></figure></li>
</ul>
<ol start="4">
<li>查询索引<br>查询索引 SQL：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> 表名;<br></code></pre></td></tr></table></figure>
如下图：<br><img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.2.1-1.png" srcset="/img/loading.gif" lazyload><br>查询结果部分字段解释：</li>
</ol>
<table>
<thead>
<tr>
<th align="center">字段名</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Table</td>
<td align="center">创建索引的表</td>
</tr>
<tr>
<td align="center">Non_unique</td>
<td align="center">表示索引非唯一，1代表非唯一索引，0代表唯一索引，意思就是该索引是不是唯一索引</td>
</tr>
<tr>
<td align="center">Key_name</td>
<td align="center">索引名称</td>
</tr>
<tr>
<td align="center">Seq_in_index</td>
<td align="center">表示该字段在索引中的位置，单列索引的话该值为1，组合索引为每个字段在索引定义中的顺序(只需要知道单列索引该值就为1，组合索引为别的)</td>
</tr>
<tr>
<td align="center">Column_name</td>
<td align="center">表示定义索引的列字段</td>
</tr>
<tr>
<td align="center">Sub_part</td>
<td align="center">表示索引的长度</td>
</tr>
<tr>
<td align="center">Null</td>
<td align="center">表示该字段是否能为空值</td>
</tr>
<tr>
<td align="center">Index_type</td>
<td align="center">表示索引类型</td>
</tr>
<tr>
<td align="center">5. Educoder代码</td>
<td align="center"></td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql">#<span class="hljs-number">1.</span>创建名为pk_student的主键索引<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student(<br>    stu_id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">25</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    age <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    sex <span class="hljs-type">char</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    classes <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    grade <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    <span class="hljs-keyword">primary</span> key(stu_id)<br>);<br><br>#<span class="hljs-number">2.</span>创建名为idx_age的普通索引<br><span class="hljs-keyword">create</span> index idx_age <span class="hljs-keyword">on</span> student(age);<br><br>#<span class="hljs-number">3.</span>创建名为uniq_classes的唯一索引<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">unique</span> index uniq_classes <span class="hljs-keyword">on</span> student(classes); <br><br>#<span class="hljs-number">4.</span>创建名为idx_group的组合索引<br><span class="hljs-keyword">create</span> index idx_group <span class="hljs-keyword">on</span> student(name,sex,grade);<br><br></code></pre></td></tr></table></figure>

<h2 id="2-3-分页和索引"><a href="#2-3-分页和索引" class="headerlink" title="2.3 分页和索引"></a>2.3 分页和索引</h2><h3 id="2-3-1-MySQL分页查询"><a href="#2-3-1-MySQL分页查询" class="headerlink" title="2.3.1 MySQL分页查询"></a>2.3.1 MySQL分页查询</h3><ol>
<li><p>什么是分页查询<br> 当一个表中有很多符合查询条件的数据的时候，我们往往不需要把他们全部一次性取出来，那样对查询效率或者服务器性能来说都会是一个极大的挑战:例如最简单的商城，假设商城中有一万个数据，但我们在前端可能只会每次看到一页10个左右的数据，当我们浏览完这十个商品后，点击下一页浏览其他的商品，这样的分页浏览，对实际存储商品数据的 MySQL 数据库来说，实际上就是使用了 MySQL 的分页查询功能。</p>
<p> 那么我们该怎么实现分页查询呢？</p>
</li>
<li><p>limit 和 offset 实现的分页查询<br> limit在之前的学习中应该有学习到，它可以返回符合条件的<code>limit</code>条数据：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>
<p> 输出： 检索记录行符合条件的10条数据</p>
<p> 那么我们也可以利用<code>limit</code>和<code>offset</code>来进行分页查询:</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">10</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>
<p> 输出：检索记录行符合条件的11-20条数据</p>
<p> <code>limit</code>之后的数字代表偏移量，<code>offset</code>代表返回记录的最大值，可以通俗的理解为，从<code>table</code>中取出第<code>limit+1</code>行到<code>limit+offset+1</code>行数据( MySQL 偏移值从0开始计算)。</p>
<p> 在实际使用中，我们可以直接把offset直接省略掉：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">10</span>,<span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>
<p> 该语句效果与带<code>offset</code>实际上是一模一样的。</p>
<p> 通过分页查询，我们可以精确的定位到行数直接取出符合条件的多条数据，但是这也同样存在着性能问题。</p>
</li>
<li><p>大数据量下分页查询优化</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">100</span>,<span class="hljs-number">100</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">1000</span>,<span class="hljs-number">100</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">10000</span>,<span class="hljs-number">100</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">100000</span>,<span class="hljs-number">100</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; limit <span class="hljs-number">1000000</span>,<span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure>

<p> 以上语句在实际使用中实际上查询速度会是越来越慢的，这是因为分页查询方式会从数据库第一条记录开始扫描，所以越往后，查询速度越慢，而且查询的数据越多，也会拖慢总查询速度。</p>
<p> 如果可以直接定位到偏移量所在记录，那么查询速度肯定能得到一个巨大的提升，所以可以考虑添加一个嵌套子查询，先查询到偏移量位置，再进行分页：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot; <span class="hljs-keyword">and</span> <br>id<span class="hljs-operator">&gt;=</span>(<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">where</span> xxx<span class="hljs-operator">=</span>&quot;xxx&quot;limit <span class="hljs-number">100000</span>,<span class="hljs-number">1</span>)<br>limit <span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure></li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">#<span class="hljs-number">1.</span>分页查询<br><span class="hljs-keyword">select</span> prod_id <span class="hljs-keyword">from</span> products limit <span class="hljs-number">5</span>,<span class="hljs-number">5</span>;<br><br>#<span class="hljs-number">2.</span>用子查询优化分页查询语句<br><span class="hljs-keyword">select</span> prod_id <span class="hljs-keyword">from</span> products<br><span class="hljs-keyword">where</span> prod_id<span class="hljs-operator">&gt;=</span>(<br>    <span class="hljs-keyword">select</span> prod_id <span class="hljs-keyword">from</span> products<br>    limit <span class="hljs-number">10</span>,<span class="hljs-number">1</span><br>) limit <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-3-2-索引（单列索引）"><a href="#2-3-2-索引（单列索引）" class="headerlink" title="2.3.2 索引（单列索引）"></a>2.3.2 索引（单列索引）</h3><ol>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> student(<br>    id <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>    score <span class="hljs-type">int</span>(<span class="hljs-number">10</span>),<br>    <span class="hljs-keyword">primary</span> key(id)<br>);<br><br>#<span class="hljs-number">2.</span>对name建立唯一索引<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">unique</span> index name_index <span class="hljs-keyword">on</span> student(name);<br><br>#<span class="hljs-number">3.</span>对score建立普通索引<br><span class="hljs-keyword">create</span> index score_index <span class="hljs-keyword">on</span> student(score);<br><br><span class="hljs-keyword">SHOW</span> INDEX <span class="hljs-keyword">FROM</span> student;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-3-3-索引（组合索引）"><a href="#2-3-3-索引（组合索引）" class="headerlink" title="2.3.3 索引（组合索引）"></a>2.3.3 索引（组合索引）</h3><ol>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">#<span class="hljs-number">1.</span>增加组合索引<br><span class="hljs-keyword">create</span> index name_city_score <span class="hljs-keyword">on</span> person(name,age,address);<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-4-存储过程"><a href="#2-4-存储过程" class="headerlink" title="2.4 存储过程"></a>2.4 存储过程</h2><h3 id="2-4-1-存储过程"><a href="#2-4-1-存储过程" class="headerlink" title="2.4.1 存储过程"></a>2.4.1 存储过程</h3><ol>
<li><p>存储过程的定义<br> <strong>存储过程</strong>（Stored Procedure）是一种在数据库中存储复杂程序，以便外部程序调用的一种数据库对象。</p>
<p> 存储过程是为了完成特定功能的 SQL 语句集，经编译创建并保存在数据库中，用户可通过指定存储过程的名字并给定参数（需要时）来调用执行。</p>
<p> 存储过程思想上很简单，就是数据库 SQL 语言层面的代码<strong>封装与重用</strong>。</p>
<p> 简单的说存储过程就是具有名字的一段代码，用来完成一个特定的功能。</p>
</li>
<li><p>存储过程的创建和查询<br> 创建存储过程：<code>create procedure 存储过程名(参数)</code> </p>
<ul>
<li>下面我们来创建第一个存储过程</li>
</ul>
<p> 每个存储的程序都包含一个由 SQL 语句组成的主体。此语句可能是由以分号（;）字符分隔的多个语句组成的复合语句。例如：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> proc1()<br><span class="hljs-keyword">BEGIN</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-keyword">END</span>;<br></code></pre></td></tr></table></figure><br> 在命令行客户端中，如果有一行命令以分号结束，那么回车后，MySQL 将会执行该命令，但在创建存储过程中我们并不希望 MySQL 这么做。</p>
<p> MySQL 本身将分号识别为语句分隔符，因此必须临时重新定义分隔符以使 MySQL 将整个存储的程序定义传递给服务器。</p>
<p> 要重新定义 MySQL 分隔符，请使用该<code>delimiter</code>命令。使用<code>delimiter</code>首先将结束符定义为&#x2F;&#x2F;，完成创建存储过程后，使用&#x2F;&#x2F;表示结束，然后将分隔符重新设置为分号（;）：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">DELIMITER <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> proc1()<br><span class="hljs-keyword">BEGIN</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-keyword">END</span> <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br>DELIMITER ;<br></code></pre></td></tr></table></figure><br> 注意：&#x2F;也可以换成其他符号，例如$;</p>
<ul>
<li>执行存储过程：<code>call 存储过程名</code><br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-1.png" srcset="/img/loading.gif" lazyload></li>
<li>创建带有参数的存储过程 存储过程的参数有三种：<ul>
<li><code>IN</code>：输入参数，也是默认模式，表示该参数的值必须在调用存储过程时指定，在存储过程中修改该参数的值不能被返回；</li>
<li><code>OUT</code>：输出参数，该值可在存储过程内部被改变，并可返回；</li>
<li><code>INOUT</code>：输入输出参数，调用时指定，并且可被改变和返回。<br> <code>IN</code>参数示例：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-2.png" srcset="/img/loading.gif" lazyload><br> <code>OUT</code>参数示例：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-3.png" srcset="/img/loading.gif" lazyload><br> <code>INOUT</code>参数示例：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-4.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
</ul>
</li>
<li><p>存储过程的查询和删除<br> 我们如何在数据库中查询我们已经创建过的存储过程呢：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">PROCEDURE</span> STATUS <span class="hljs-keyword">WHERE</span> db<span class="hljs-operator">=</span><span class="hljs-string">&#x27;数据库名&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p> 查看存储过程的详细定义信息：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> 数据库.存储过程名;<br></code></pre></td></tr></table></figure>
<p> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-5.png" srcset="/img/loading.gif" lazyload><br> 当我们不再需要某个存储过程时，我们可以使用：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PROCEDURE</span> [IF <span class="hljs-keyword">EXISTS</span>] 数据库名.存储过程名;<br></code></pre></td></tr></table></figure>
<p> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.4.1-6.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql">delimiter <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> GetCustomerLevel(<span class="hljs-keyword">in</span> p_customNumber <span class="hljs-type">int</span>(<span class="hljs-number">11</span>),<span class="hljs-keyword">out</span> p_customerLevel <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>))<br><span class="hljs-keyword">begin</span><br>    <span class="hljs-keyword">declare</span> creditlim <span class="hljs-type">int</span>(<span class="hljs-number">11</span>);<br>    <span class="hljs-keyword">select</span> creditlimit <span class="hljs-keyword">into</span> creditlim <span class="hljs-keyword">from</span> customers <span class="hljs-keyword">where</span> customerNumber<span class="hljs-operator">=</span>p_customNumber;<br>    if creditlim<span class="hljs-operator">&gt;</span><span class="hljs-number">10000</span> <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">set</span> p_customerLevel<span class="hljs-operator">=</span><span class="hljs-string">&#x27;PLATINUM&#x27;</span>;<br>    elseif creditlim<span class="hljs-operator">&gt;=</span><span class="hljs-number">5000</span> <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">set</span> p_customerLevel<span class="hljs-operator">=</span><span class="hljs-string">&#x27;GOLD&#x27;</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">set</span> p_customerLevel<span class="hljs-operator">=</span><span class="hljs-string">&#x27;SILVER&#x27;</span>;<br>    <span class="hljs-keyword">end</span> if;<br>    <span class="hljs-keyword">select</span> p_customNumber <span class="hljs-keyword">as</span> customerNumber,p_customerLevel;<br><span class="hljs-keyword">end</span> <span class="hljs-operator">/</span><span class="hljs-operator">/</span><br>delimiter ;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-5-事务"><a href="#2-5-事务" class="headerlink" title="2.5 事务"></a>2.5 事务</h2><h3 id="2-5-1-事务"><a href="#2-5-1-事务" class="headerlink" title="2.5.1 事务"></a>2.5.1 事务</h3><ol>
<li><p>什么是事务<br> 可以把一系列要执行的操作称为<strong>事务</strong>，而事务管理就是管理这些操作要么完全执行，要么完全不执行。</p>
<p> 经典的事务举例：A要给B转钱，首先A的钱减少了，但是突然的数据库断电了，导致无法给B加钱，然后由于丢失数据，B不承认收到A的钱；在这里事务就是确保加钱和减钱两个都完全执行或完全不执行，如果加钱失败，那么不会发生减钱。</p>
<p> 事务管理的意义：<strong>保证数据操作的完整性</strong>；</p>
<p> 事务的特性；</p>
<ul>
<li><p>原子性：事务的整个操作是一个整体，不可以分割，要么全部成功，要么全部失败；</p>
</li>
<li><p>一致性：事务操作的前后，数据表中的数据没有变化（按示例中解释为A转钱给B的前后两个人钱的总金额不会改变）；</p>
</li>
<li><p>隔离性：事务操作是相互隔离不受影响的；</p>
</li>
<li><p>持久性：数据一旦提交，不可改变，永久的改变数据表数据</p>
</li>
</ul>
</li>
<li><p>事务的开启与提交<br> 在 MySQL 命令行的默认下，事务采用<strong>自动提交</strong>（autocommit&#x3D;1）模式。意味着，当你执行一个修改sql语句，MySQL会立刻更新存储到磁盘中。也就是会立马执行<code>commit</code>操作。<br> 因此开启一个手动事务必须使用<code>begin</code>，<code>start transaction</code>或者<code>set autocommit=0</code>：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">begin</span>;<br>#或者<br><span class="hljs-keyword">start</span> TRANSACTION;<br>#或者<br><span class="hljs-keyword">set</span> autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure>
<p> <code>commit</code>表示提交事务，即提交事务的所有操作。具体地说，就是将事务中所有对数据库的更新写回到磁盘上的物理数据库中，事务正常结束。<br> 提交事务也有对应的三种方式：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">commit</span>;<br>#或者<br><span class="hljs-keyword">commit</span> TRANSACTION;<br>#或者<br><span class="hljs-keyword">commit</span> WORK;<br></code></pre></td></tr></table></figure>
<p> 提交事务，意味着将事务开始以来所执行的所有数据修改成为数据库的永久部分，因此也标志着一个事务的结束。一旦执行了该命令，将不能回滚事务。只有在所有修改都准备好提交给数据库时，才执行这一操作。<br> 下面使用两个连接举例说明：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.5.1-1.png" srcset="/img/loading.gif" lazyload><br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.5.1-2.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>回滚事务<br> <code>rollback</code>表示事务回滚，即在事务运行的过程中发生了某种故障，事务不能继续执行，系统将事务中对数据库的所有已完成的操作（对数据库的更新操作）全部撤销，回滚到事务开始时的状态，同时，系统将释放由事务控制的资源。因此，这条语句也标志着事务的结束。<br> 示例：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.5.1-3.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 修改存储过程 ———— 向 t_emp 表中插入数据（注意请勿修改提供的代码框架） <br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">procedure</span> if <span class="hljs-keyword">exists</span> mydb.proc_insert;<br>delimiter $$<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> proc_insert()<br><span class="hljs-keyword">Begin</span> <br> <span class="hljs-keyword">declare</span> err <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">declare</span> continue handler <span class="hljs-keyword">for</span> <span class="hljs-keyword">sqlexception</span> <span class="hljs-keyword">set</span> err<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br> #开启事务<br> <span class="hljs-keyword">start</span> transaction ;<br>    <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp <span class="hljs-keyword">values</span>(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;Tom&#x27;</span>,<span class="hljs-number">302</span>,<span class="hljs-number">4800</span>);<br>    <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp <span class="hljs-keyword">values</span>(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;Tony&#x27;</span>,<span class="hljs-number">302</span>,<span class="hljs-number">5900</span>);<br> <span class="hljs-keyword">update</span> t_emp <span class="hljs-keyword">set</span> salary<span class="hljs-operator">=</span><span class="hljs-number">0</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br> <span class="hljs-keyword">update</span> t_emp <span class="hljs-keyword">set</span> salery<span class="hljs-operator">=</span><span class="hljs-number">8000</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">2</span>;<br> #事务提交<br>    if err<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">then</span><br>        <span class="hljs-keyword">rollback</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">commit</span>;<br>    <span class="hljs-keyword">end</span> if;<br><span class="hljs-keyword">END</span> $$<br>delimiter ;<br><br>#<span class="hljs-number">1.</span>向 t_emp 表中插入数据<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Nancy&#x27;</span>,<span class="hljs-number">301</span>,<span class="hljs-number">2300</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp <span class="hljs-keyword">values</span>(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;Tod&#x27;</span>,<span class="hljs-number">303</span>,<span class="hljs-number">5600</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp <span class="hljs-keyword">values</span>(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;Carly&#x27;</span>,<span class="hljs-number">301</span>,<span class="hljs-number">3200</span>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-6-并发控制"><a href="#2-6-并发控制" class="headerlink" title="2.6 并发控制"></a>2.6 并发控制</h2><h3 id="2-6-1-表锁"><a href="#2-6-1-表锁" class="headerlink" title="2.6.1 表锁"></a>2.6.1 表锁</h3><ol>
<li><p>MySQL存储引擎<br> 引擎：数据存在数据库中不同的格式和方法。<br> MySQL最常用引擎：<code>MyISAM</code>和<code>InnoDB</code>，在MySQL 5.5.5以前，默认的存储引擎为<code>MyISAM</code>，之后版本默认为<code>InnoDB</code>。<code>InnoDB</code>对事物完整性更好以及有更高的并发性，下面了解一下他们之间的区别：</p>
<table>
<thead>
<tr>
<th align="center">对比项</th>
<th align="center">MyISAM</th>
<th align="center">InnoDB</th>
</tr>
</thead>
<tbody><tr>
<td align="center">主外键</td>
<td align="center">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">事务</td>
<td align="center">不支持</td>
<td align="center">支持</td>
</tr>
<tr>
<td align="center">行表锁</td>
<td align="center">锁。操作一条记录也会锁住整个表</td>
<td align="center">行锁。操作时只锁某一行</td>
</tr>
<tr>
<td align="center">缓存</td>
<td align="center">只缓存索引，不缓存真实数据</td>
<td align="center">不仅缓存索引，还缓存真实数据</td>
</tr>
<tr>
<td align="center">表空间</td>
<td align="center">小</td>
<td align="center">大</td>
</tr>
<tr>
<td align="center">关注点</td>
<td align="center">性能</td>
<td align="center">事务</td>
</tr>
<tr>
<td align="center">默认安装</td>
<td align="center">是</td>
<td align="center">是</td>
</tr>
</tbody></table>
</li>
<li><p>锁机制<br> 问：锁是什么，有什么用？<br> 答：锁的主要作用是管理共享资源的并发访问，锁可以用于实现事务的隔离。<br> 问：为什么要加锁？<br> 答：为了避免多个事务同时操作数据库导致数据异常，一般会通过锁机制解决。<br> 锁的分类：</p>
<ul>
<li>从对数据操作的类型（读&#x2F;写）分类：共享锁（读锁）、排它锁（写锁）；</li>
<li>从对数据操作的粒度分：表锁、行锁。<br> 下面用一张图说明所之间的关系：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-1.png" srcset="/img/loading.gif" lazyload><br> <strong>加锁原则</strong>：对于MySQL的InnoDB引擎来说，insert、update、delete等操作，会自动给涉及的数据加排他锁；对于一般的select语句，InnoDB不会加任何锁，但在事务可以通过指定SQL语句给显示加共享锁或排他锁。</li>
</ul>
</li>
<li><p>表锁<br> 偏向<code>MyISAM</code>存储引擎，开销小，加锁快，无死锁，锁定粒度大，发送锁冲突的概率最高，并发度最低。</p>
</li>
<li><p>乐观锁和悲观锁的概念<br> 乐观锁是指操作数据库时（更新操作），想法很乐观，认为这次的操作不会导致冲突，在操作数据时，并不进行任何其他的特殊处理（也就是不加锁），而在进行更新后，再去判断是否有冲突了。<br> 悲观锁就是在操作数据时，认为此操作会出现数据冲突，所以在进行每次操作时都要通过获取锁才能进行对相同数据的操作，因此悲观锁需要耗费较多的时间。<br> 悲观锁是由数据库自己实现了的，要用的时候，我们直接调用数据库的相关语句就可以了。<br> 说到这里，由悲观锁涉及到的另外两个锁概念就出来了，它们就是读锁与写锁。下面就让我们一起来学习表锁如何添加读写锁。</p>
</li>
<li><p>如何给表添加读写锁<br> 为什么要给表添加锁呢？<br> 不加锁，若同事两个人修改同一张表的数据，当再次查询时，其中一个总会发现莫名其妙表数据被修改了。因此我们需要添加锁。<br> 在给表添加锁之前，我们首先要创建一张使用<code>MyISAM</code>存储引擎的mylock表：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> mylock(<br>    id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">primary</span> key auto_increment,<br>    name <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>)<br>)engine myisam;<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> mylock(name) <span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;a&#x27;</span>),(<span class="hljs-string">&#x27;b&#x27;</span>),(<span class="hljs-string">&#x27;c&#x27;</span>),(<span class="hljs-string">&#x27;d&#x27;</span>),(<span class="hljs-string">&#x27;e&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p> 我们通过<code>show open tables</code>查看数据库中有没有加锁的表：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-2.png" srcset="/img/loading.gif" lazyload><br> 查询结果中In_use列中值全为0，说明没有表被锁，我们手动给表增加锁：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">lock <span class="hljs-keyword">table</span> 表名 read(write),表名<span class="hljs-number">2</span> read(write)，其他；<br></code></pre></td></tr></table></figure>
<p> 下面给数据库中的<code>account</code>表上写锁，给<code>mylock</code>上读锁:<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-3.png" srcset="/img/loading.gif" lazyload><br> 发现In_use均为1，那么要怎么解锁呢？<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-4.png" srcset="/img/loading.gif" lazyload><br> 下面我们具体来看添加锁的作用：<br> ① 添加读锁后的特征：多个连接对于同一数据都能访问，但是只能读不能修改，要想修改除非开启锁的连接将锁关闭。<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-5.gif" srcset="/img/loading.gif" lazyload><br> 但是这种方式会是性能变的很慢，当我们还有多个连接也在等待修改时，会消耗很多时间。<br> ② 添加写锁后的特征：多个连接对于同一数据不能同时访问，但加锁的连接中可以更新表数据，另一个连接要想访问数据，必须解锁。<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.1-6.gif" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Tom&#x27;</span>,<span class="hljs-number">80</span>,<span class="hljs-number">78</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> student <span class="hljs-keyword">values</span>(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;Lucy&#x27;</span>,<span class="hljs-number">97</span>,<span class="hljs-number">95</span>);<br>lock <span class="hljs-keyword">table</span> student read;<br><span class="hljs-keyword">update</span> student <span class="hljs-keyword">set</span> math<span class="hljs-operator">=</span><span class="hljs-number">100</span> <span class="hljs-keyword">where</span> stu_id<span class="hljs-operator">=</span><span class="hljs-number">2</span>;<br>unlock tables;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-6-2-事务隔离级别"><a href="#2-6-2-事务隔离级别" class="headerlink" title="2.6.2 事务隔离级别"></a>2.6.2 事务隔离级别</h3><ol>
<li><p>事务并发下出现的问题<br> 通常事务并发会出现几种现象：1.脏读；2.不可重复读；3.幻读。</p>
<ul>
<li>脏读<br> 一个事务 A 读取了另一个并行事务 B 未最终提交的写数据, 那事务A的这次读取就是脏读。<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.2-1.png" srcset="/img/loading.gif" lazyload></li>
<li>不可重复读<br> 假设“脏读”问题完全解决了，那就意味着事务中每次读取到的数据都是“持久性”的数据（被别的事务最终“提交&#x2F;回滚”完成后的数据）。<br> 但是解决了脏读问题, 只是能保证你在事务中每次读到的数据都是持久性的数据而已!<br> 如果在 一个事务 中多次读取同一个数据，正好在两次读取之间，另外一个事务确实已经完成了对该数据的修改并提交，那问题就来了，可能会出现 多次读取结果不一致 的现象，这种现象也就被称为不可重复读：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.2-2.png" srcset="/img/loading.gif" lazyload></li>
<li>幻读<br> 事务 A 在执行读取操作，需要两次统计数据的总量，前一次查询数据总量后，此时事务 B 执行了新增数据的操作并提交后，这个时候事务 A 读取的数据总量和之前统计的不一样，就像产生了幻觉一样，平白无故的多了几条数据，这种现象就称为幻读：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.2-3.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
<li><p>事务隔离级别<br> 针对上面所出现的问题，数据库提出了对应的解决方案，就是事务的隔离级别：</p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>未提交读（Read uncommitted）</td>
<td>可能</td>
<td>可能</td>
<td>可能</td>
</tr>
<tr>
<td>已提交读（Read committed）</td>
<td>不可能</td>
<td>可能</td>
<td>可能</td>
</tr>
<tr>
<td>可重复度（Repeatable read）</td>
<td>不可能</td>
<td>不可能</td>
<td>可能</td>
</tr>
<tr>
<td>可串行化（Serializable）</td>
<td>不可能</td>
<td>不可能</td>
<td>不可能</td>
</tr>
</tbody></table>
<p> 未提交读：就是一个事务可以读取另一个未提交事务的数据。<br> 已提交读：就是一个事务要等另一个事务提交后才能读取数据。（ O\fracle 数据库的默认级别）<br> 可重复读：就是在开始读取数据（事务开启）时，不再允许修改操作，也是 MySQL 数据库的默认隔离级别。<br> 可串行化：意思是说这个事务执行的时候不允许别的事务 并发写 操作的执行。这是事务隔离的最高级别，虽然最安全最省心，但是效率太低，一般不会用。</p>
<ol>
<li>查询事务级别<br> 查询事务级别的 SQL如下： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@tx_isolation</span>;<br></code></pre></td></tr></table></figure>
 例如，查询 MySQL 的默认级别：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.2-4.png" srcset="/img/loading.gif" lazyload></li>
<li>修改数据库的事务级别<br> 事务级别是可以被修改了，那么修改的 SQL 如下： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL 事务级别；<br></code></pre></td></tr></table></figure>
 例如，我们将 MySQL 的事务级别修改成未提交读：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.2-5.png" srcset="/img/loading.gif" lazyload></li>
</ol>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">#<span class="hljs-number">1.</span>修改隔离级别<br><span class="hljs-keyword">set</span> session transaction isolation level read uncommitted;<br>#<span class="hljs-number">2.</span>查询隔离级别<br><span class="hljs-keyword">select</span> @<span class="hljs-variable">@tx_isolation</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-6-3-行锁"><a href="#2-6-3-行锁" class="headerlink" title="2.6.3 行锁"></a>2.6.3 行锁</h3><ol>
<li>丢失更新的定义及产生原因<br> 如果两事务都在对数据进行修改则会导致另外的问题：丢失更新。<br> 丢失更新就是两个不同的事务在某一时刻对同一数据进行读取后，先后进行修改，导致第一次操作数据丢失：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.3-1.gif" srcset="/img/loading.gif" lazyload><br> 该问题和之前事务并发出现的几个问题需要区分开, 因为解决方案不是一类！此类问题，只能用最高隔离级别 Serializable 或者手动使用锁来解决，本关我们就一起学习如何使用锁来解决。</li>
<li>如何解决丢失更新问题<br> 由第一关介绍存储引擎后，我们知道 InnoDB 存储引擎才支持事务，因此我们使用 行锁 来解决，我们还介绍了行锁包括悲观锁和乐观锁，悲观锁包含了读锁和写锁，下面我们就使用悲观锁的两种方式来解决。<ol>
<li><p>使用共享锁<br> 共享锁（S），又称为读锁，获得共享锁之后，针对同一份数据，多个读操作可以同时进行，互不影响，但无法修改和删除数据。<br> 例如：我在客户端 A 给数据 C 添加了共享锁，此时我在客户端 B 只能添加共享锁进行查看，没有修改的权利，如果我想要在客户端 B 进行修改，我只能在 A 处commit才能进行修改。<br> 在查询语句后面增加<code>LOCK IN SHARE MODE</code>，MySQL 会对查询结果中的每行都加共享锁：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> ... lock <span class="hljs-keyword">in</span> share mode;<br></code></pre></td></tr></table></figure>
<p> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.3-2.gif" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>使用派他锁<br> 排他锁（X），又称为写锁、独占锁。获得排他锁后，在当前写操作没有完成前，它会阻断其他写锁和读锁。<br> 排它锁就是我在客户端 A 给数据 C 添加了排它锁，那么我在客户端 B 只能在客户端 A commit之后，才能select数据。<br> 换句话说，只要我在客户端 B 用锁进行了查询，那我我都需要等待 A commit之后，如果此时我客户端 B 不加锁，我是可以查询到的。<br> 添加排它锁的方式：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> ... <span class="hljs-keyword">for</span> <span class="hljs-keyword">update</span>;<br></code></pre></td></tr></table></figure>
<p> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.3-3.gif" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
</li>
<li>Educoder截图<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.3-a.png" srcset="/img/loading.gif" lazyload><br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.6.3-b.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<h2 id="2-7-行列转换"><a href="#2-7-行列转换" class="headerlink" title="2.7 行列转换"></a>2.7 行列转换</h2><h3 id="2-7-1-使用case语句实现行列转换"><a href="#2-7-1-使用case语句实现行列转换" class="headerlink" title="2.7.1 使用case语句实现行列转换"></a>2.7.1 使用case语句实现行列转换</h3><ol>
<li>统计打怪数问题<br> 观察下面数据，我们需要将左边<code>hunt</code>表中的信息转换成右边<code>info</code>表，那么我们应该如何编写SQL来实现呢？<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-1.png" srcset="/img/loading.gif" lazyload></li>
<li>SQL分析<br> 现<code>hunt</code>表结构如下：<table>
<thead>
<tr>
<th align="center">字段名</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td align="center">姓名</td>
</tr>
<tr>
<td align="center">kills</td>
<td align="center">打怪数</td>
</tr>
<tr>
<td align="center">要转换成右边<code>info</code>表格式，我们首先需要两个步骤：</td>
<td align="center"></td>
</tr>
</tbody></table>
<ul>
<li>数据汇总<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-2.png" srcset="/img/loading.gif" lazyload></li>
<li>行转列<br> 现在我们得到的数据和最终数据还存在差异，那么我们要怎么进行转换呢？我们其实可以获取单独的每个人的打怪总数：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-3.png" srcset="/img/loading.gif" lazyload><br> 那么我们只要能将三组数据合并成一组数据并按行的形式来显示，不就可以得到右边<code>info</code>表了吗。<br> 现在是不是都想到了使用<code>inner join</code>来将SQL进行连接，再将得到的<code>sum(kills)</code>字段名改成对应的名称就完美了。<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-4.png" srcset="/img/loading.gif" lazyload><br> 注意：效果我们虽然达到了，但是同学们也都发现了使用这种方式来进行行转列是有缺点的。<br> 例如，我们的连接次数会随着<code>name</code>的增加而增加，用户数量越多我们需要连接的表也就越多，总的来说效率不高，且也会给我们编写SQL带来复杂性。</li>
</ul>
</li>
<li>SQL编写<br> 下面我们来看另外一种方式，相当于<code>inner join</code>来说使用<strong>CASE语句来进行行列转换会更加通用简洁</strong>，下面我们就一起来看看如何使用CASE语句转换：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-5.png" srcset="/img/loading.gif" lazyload><br> 那么为什么要使用<code>SUM</code>聚合函数呢？那就来看看我们去掉<code>SUM</code>后的结果：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-6.png" srcset="/img/loading.gif" lazyload><br> 看了上面的查询结果，应该会猜到原因，执行SQL时，查询表中第一条记录时，<code>name</code>为孙悟空，<code>kills</code>为20，然后就被<code>case</code>语句转成<code>kills</code>即20。那么后面两个<code>case</code>因为在这一行中没被匹配到，因此都输出<code>NULL</code>。<br> 或者我们还可以使用<code>IF</code>函数：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.1-7.png" srcset="/img/loading.gif" lazyload></li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> s_name,<br><span class="hljs-built_in">sum</span>(<span class="hljs-keyword">case</span> c_name <span class="hljs-keyword">when</span> <span class="hljs-string">&#x27;语文&#x27;</span> <span class="hljs-keyword">then</span> s_score <span class="hljs-keyword">end</span>) <span class="hljs-string">&#x27;语文&#x27;</span>,<br><span class="hljs-built_in">sum</span>(<span class="hljs-keyword">case</span> c_name <span class="hljs-keyword">when</span> <span class="hljs-string">&#x27;数学&#x27;</span> <span class="hljs-keyword">then</span> s_score <span class="hljs-keyword">end</span>) <span class="hljs-string">&#x27;数学&#x27;</span>,<br><span class="hljs-built_in">sum</span>(<span class="hljs-keyword">case</span> c_name <span class="hljs-keyword">when</span> <span class="hljs-string">&#x27;英语&#x27;</span> <span class="hljs-keyword">then</span> s_score <span class="hljs-keyword">end</span>) <span class="hljs-string">&#x27;英语&#x27;</span><br><span class="hljs-keyword">from</span> score<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> s_name;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-7-2-序列化表的方法实现列转行（一）"><a href="#2-7-2-序列化表的方法实现列转行（一）" class="headerlink" title="2.7.2 序列化表的方法实现列转行（一）"></a>2.7.2 序列化表的方法实现列转行（一）</h3><ol>
<li><p>问题<br> 列转行有两种情况，一种是源数据只有一列并通过某种符号分隔的字符串，我们需要将字符串分成多行显示；另一种是表本身是多列的数据，我们需要转成多行。</p>
</li>
<li><p>情景一<br> 首先我们来看第一种情况，有上表转换成下表：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.2-1.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>SQL分析及编写<br> 这种类型问题我们如何进行列转行呢？可以利用序列化表来解决。所谓序列表，顾名思义就是存着序列号的一张表（表中的数量需要和你），如下<code>sequence</code>表：</p>
<table>
<thead>
<tr>
<th align="center">id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
</tr>
<tr>
<td align="center">3</td>
</tr>
<tr>
<td align="center">…</td>
</tr>
</tbody></table>
<p> 下面就是利用序列化实现的SQL：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.2-2.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>首先我们来看看子查询做了些什么：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.2-3.png" srcset="/img/loading.gif" lazyload><br> 这个查询的目的很简单，就是通过计算<code>mobile</code>列中,的个数+1来得到有多少个电话号码。</li>
<li>使用序列化表<code>inner join</code>来对上面结果集进行关联，注意关联条件<code>a.id&lt;=b.size</code>，也就对应每个<code>user_name</code>的<code>size</code>行数，例如不进行数据的截取，直接输出的结果如下：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.2-4.png" srcset="/img/loading.gif" lazyload></li>
<li>那么得到如下数据后，最后的结果输出就简单了，只要进行字符串的截取我们就大功告成了。</li>
</ul>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> b.name,<br>substring_index(replace(<span class="hljs-built_in">substring</span>(substring_index(b.scores,<span class="hljs-string">&#x27;,&#x27;</span>,s.id),<span class="hljs-keyword">char_length</span>(substring_index(b.scores,<span class="hljs-string">&#x27;,&#x27;</span>,s.id<span class="hljs-number">-1</span>))<span class="hljs-operator">+</span><span class="hljs-number">1</span>),<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>),<span class="hljs-string">&#x27;:&#x27;</span>,<span class="hljs-number">1</span>) course,<br>substring_index(replace(<span class="hljs-built_in">substring</span>(substring_index(b.scores,<span class="hljs-string">&#x27;,&#x27;</span>,s.id),<span class="hljs-keyword">char_length</span>(substring_index(b.scores,<span class="hljs-string">&#x27;,&#x27;</span>,s.id<span class="hljs-number">-1</span>))<span class="hljs-operator">+</span><span class="hljs-number">1</span>),<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>),<span class="hljs-string">&#x27;:&#x27;</span>,<span class="hljs-number">-1</span>) score<br><span class="hljs-keyword">from</span> tb_sequence s <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> <br>(<span class="hljs-keyword">select</span> name,scores <span class="hljs-keyword">as</span> course,scores,length(scores)<span class="hljs-operator">-</span>length(replace(scores,<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))<span class="hljs-operator">+</span><span class="hljs-number">1</span> size<br><span class="hljs-keyword">from</span> tb_score) b <br><span class="hljs-keyword">on</span> s.id <span class="hljs-operator">&lt;=</span> b.size;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-7-3-序列化表的方法实现列转行（二）"><a href="#2-7-3-序列化表的方法实现列转行（二）" class="headerlink" title="2.7.3 序列化表的方法实现列转行（二）"></a>2.7.3 序列化表的方法实现列转行（二）</h3><ol>
<li>情景二<br> 接着上一章节，现在我们来看第二种情况，表中本身就有多列数据，需要你将其转为多行：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-1.png" srcset="/img/loading.gif" lazyload></li>
<li>SQL分析<br> 首先我们将问题简单化一下，若我们不需要这么多列，只需要将其中某列数据转成行的形式，下面以取出每个人<code>mobile1</code>的电话为例，则SQL如下：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-2.png" srcset="/img/loading.gif" lazyload><br> 但是这个显示中我们并不能看出是<code>mobile1</code>的值，为了和所需更接近，我们需要再添加一列：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-3.png" srcset="/img/loading.gif" lazyload><br> 以此类推，我们同样可以将<code>mobile2</code>和<code>mobile3</code>列表，那么我们是不是只需要将这三组数据成一个就能实现列转行的转换了，我们就使用<code>union</code>来进行连接为了达到和我们预期的结果一样，我们通过姓名排序得到最终结果：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-4.png" srcset="/img/loading.gif" lazyload><br> 观察SQL我们可能都发现了，使用<code>union</code>的方式实现列转行并不太方便，如果还有更多的<code>mobilen</code>的话，我们所需要连接的表就会随着增加，长度不好控制。    </li>
<li>SQL编写<br> 那么我们是否可以使用上一章节中提到过的序列化表来实现呢？显然是可以的，下面我们就一起来使用序列化表的方式实现一行转三行。<ul>
<li>首先，我们需要通过序列表进行笛卡尔积连接，这里我们只需要将一行转成三行，因此使用id&lt;&#x3D;3即可，为了使大家更清晰观察数据我们通过姓名进行排序；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-5.png" srcset="/img/loading.gif" lazyload></li>
<li>但是上面表中的三条数据我们对每个用户都只需要其中的一条，然后进行组装就行，那么这个时候就要用到我们的<code>CASE</code>语句了；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-6.png" srcset="/img/loading.gif" lazyload></li>
<li>那么接下来我们就可以使用<code>coalesce()</code>函数来只取非空值；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-7.png" srcset="/img/loading.gif" lazyload></li>
<li>此时和我们所要的结果就比较相近了，只差一列数据，我们仍使用<code>CASE</code>语句来进行最后一列的SQL编写。<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.7.3-8.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> s_name,<br><span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;语文&#x27;</span> <br><span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;英语&#x27;</span> <br><span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">3</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;数学&#x27;</span> <br><span class="hljs-keyword">end</span> <span class="hljs-keyword">as</span> s_cource,<br><span class="hljs-built_in">coalesce</span>(<br>    <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">then</span> chinese <span class="hljs-keyword">end</span>,<br>    <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">then</span> english <span class="hljs-keyword">end</span>,<br>    <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> a.id<span class="hljs-operator">=</span><span class="hljs-number">3</span> <span class="hljs-keyword">then</span> math <span class="hljs-keyword">end</span><br>) <span class="hljs-keyword">as</span> s_score<br><span class="hljs-keyword">from</span> tb_score <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> tb_sequence a <span class="hljs-keyword">where</span> a.id<span class="hljs-operator">&lt;=</span><span class="hljs-number">3</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> s_name;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-8-删除重复数据"><a href="#2-8-删除重复数据" class="headerlink" title="2.8 删除重复数据"></a>2.8 删除重复数据</h2><h3 id="2-8-1-利用主键删除"><a href="#2-8-1-利用主键删除" class="headerlink" title="2.8.1 利用主键删除"></a>2.8.1 利用主键删除</h3><ol>
<li>重复数据<br> 下面我们来看一组数据，users表结构及数据如下：<table>
<thead>
<tr>
<th align="center">id（主键）</th>
<th align="center">user_name</th>
<th align="center">user_pwd</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">user1</td>
<td align="center">123</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">user2</td>
<td align="center">456</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">user3</td>
<td align="center">789</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">user1</td>
<td align="center">111</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">user1</td>
<td align="center">222</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">user1</td>
<td align="center">333</td>
</tr>
</tbody></table>
 上面<code>users</code>表中出现了相同用户名的重复数据，我们需要将其重复的删除，首先我们将重复用户查出来：<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.8.1-1.png" srcset="/img/loading.gif" lazyload><br> 找到重复的用户后我们要怎么删除呢？又要怎么选择保留的数据呢？</li>
<li>解题思路<br> 假设我们要保留的数据为先注册的账号，我们可将思路拟定如下：<ul>
<li>确定了保留先注册的账号，也就等同保留的数据为id较小的，我们可利用 聚合函数 得到重复数据中的最小id用户；</li>
<li>使用表关联，将重复数据中最小id用户与源users表中的id进行对比，删除users表中id比重复数据中的最小id 大 的记录，删除后表中的数据就是先注册用户的数据了。</li>
</ul>
</li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span>(<br>    <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<br>        <span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> user_name <span class="hljs-keyword">in</span>(<br>            <span class="hljs-keyword">select</span> user_name <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_name <span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><br>        ) <span class="hljs-keyword">and</span> id <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<br>            <span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(id) <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_name <span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><br>        ) <br>    ) <span class="hljs-keyword">as</span> user_copy<br>);<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-8-2-复杂重复数据删除"><a href="#2-8-2-复杂重复数据删除" class="headerlink" title="2.8.2 复杂重复数据删除"></a>2.8.2 复杂重复数据删除</h3><ol>
<li>重复数据<br> 下面我们继续看一组数据，仍用上一章节的<code>users</code>表，现在多一列<code>mobile</code>数据：<table>
<thead>
<tr>
<th align="center">id（主键）</th>
<th align="center">user_name</th>
<th align="center">user_pwd</th>
<th align="center">mobile</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">user1</td>
<td align="center">123</td>
<td align="center">18212345678,18201234567,18212345678</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">user2</td>
<td align="center">456</td>
<td align="center">18266666666,18288888888</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">user3</td>
<td align="center">789</td>
<td align="center">18268686868,18278787878,18268686868,18278787878</td>
</tr>
</tbody></table>
</li>
<li>解题思路<br> 遇到这种情况要将数据去重，我们的解题思路基本就可以拟定为把数据拆开后去重再将数据重新组合。<br> 下面我们细分成几个小步骤来看：<ul>
<li>统计mobile列中各用户的电话数量；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.8.2-1.png" srcset="/img/loading.gif" lazyload></li>
<li>拆分数据（连接序列化表）；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.8.2-2.png" srcset="/img/loading.gif" lazyload></li>
<li>截取数据；<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.8.2-3.png" srcset="/img/loading.gif" lazyload></li>
<li>最后一步我们只需要将数据去重，然后再分组进行组合就大功告成了。</li>
</ul>
</li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> users b<br><span class="hljs-keyword">JOIN</span> (<br>    <span class="hljs-keyword">SELECT</span> user_name,<br>        GROUP_CONCAT(<span class="hljs-keyword">DISTINCT</span> SUBSTRING_INDEX(SUBSTRING_INDEX(mobile, <span class="hljs-string">&#x27;,&#x27;</span>, t.id), <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-number">-1</span>)) <span class="hljs-keyword">AS</span> mobile<br>    <span class="hljs-keyword">FROM</span> (<br>        <span class="hljs-keyword">SELECT</span> user_name,<br>            mobile,<br>            LENGTH(CONCAT(mobile, <span class="hljs-string">&#x27;,&#x27;</span>)) <span class="hljs-operator">-</span> LENGTH(REPLACE(mobile, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)) <span class="hljs-keyword">AS</span> size<br>        <span class="hljs-keyword">FROM</span> users<br>    ) a<br>    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> tb_sequence t <span class="hljs-keyword">ON</span> a.size <span class="hljs-operator">&gt;=</span> t.id<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> a.user_name<br>) c <span class="hljs-keyword">ON</span> b.user_name <span class="hljs-operator">=</span> c.user_name<br><span class="hljs-keyword">SET</span> b.mobile <span class="hljs-operator">=</span> c.mobile;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-9-批量数据入库及检索"><a href="#2-9-批量数据入库及检索" class="headerlink" title="2.9 批量数据入库及检索"></a>2.9 批量数据入库及检索</h2><h3 id="2-9-1-MySQL数据库连接"><a href="#2-9-1-MySQL数据库连接" class="headerlink" title="2.9.1 MySQL数据库连接"></a>2.9.1 MySQL数据库连接</h3><ol>
<li><p>任务描述<br> <code>Python</code>可以通过<code>MySQLdb</code>库连接MySQL数据库，但<code>Python3</code>之后不再支持MySQLdb库，需要通过<code>pymysql</code>库连接。<br> <code>pymysql</code>通过<code>connect</code>方法连接数据库，如：</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>,passwd=<span class="hljs-string">&#x27;123456&#x27;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br></code></pre></td></tr></table></figure></li>
<li><p>相关知识<br> connect方法的参数含义如下：</p>
 <figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">host：数据库主机名，默认是用本地主机<br>user：数据库登陆名，默认是当前用户<br>passwd：数据库登陆的密码，默认为空<br><span class="hljs-symbol">charset:</span>连接时的编码格式，要求与数据库的编码一致<br></code></pre></td></tr></table></figure>
<p> 在安装MySQL数据库环境时，会选择默认编码格式，建议选择<code>utf8</code>格式；若登录名或密码错误时，返回如下错误<br> <code>pymysql.err.OperationalError: (1045, &quot;Access denied for user &#39;a&#39;@&#39;localhost&#39; (using password: YES)&quot;)</code></p>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>,user=<span class="hljs-string">&#x27;root&#x27;</span>,passwd=<span class="hljs-string">&#x27;123123&#x27;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-9-2-数据库与数据表创建"><a href="#2-9-2-数据库与数据表创建" class="headerlink" title="2.9.2 数据库与数据表创建"></a>2.9.2 数据库与数据表创建</h3><ol>
<li>任务描述<br> 在MySQL中创建属于自己的数据库，根据需求在库中创建相应的表，将数据存入表中，方便对数据的管理与查询。如汽车零售商将汽车信息存入数据库中方便管理，可创建数据库： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">cursor.execute(<span class="hljs-string">&#x27;create database carinfo&#x27;</span>)<br></code></pre></td></tr></table></figure>
 与汽车相关的信息可能包括汽车购入信息和汽车出售信息，可以分别在carinfo库中建立对应的表： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">cursor.execute(<span class="hljs-string">&#x27;create table ininfo (indata data,inNum int, brand varchar(255))&#x27;</span>)<br>cursor.execute(<span class="hljs-string">&#x27;create table outinfo (outdata data,outNum int, brand varchar(255))&#x27;</span>)<br></code></pre></td></tr></table></figure>
 本关任务是，创建enroll数据库，并在enroll创建nudt表。</li>
<li>相关知识<ol>
<li>获取游标<br> 前面已经介绍过如何获取数据库连接对象，但是不能在这个对象上直接对数据库进行操作， 还需要获取对应的操作游标才能进行数据库的操作： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cursor = conn.cursor()<br></code></pre></td></tr></table></figure>
 游标是一种数据访问对象，可用于创建数据库和数据表，也可用于在表中迭代一组行或者向表中插入新行。</li>
<li>确定使用的数据库<br> MySQL中可能同时存在多个数据库，为了对指定的数据库进行操作，可使用： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">dbName = 你的数据库名称<br>conn.select_db(dbName)<br></code></pre></td></tr></table></figure>
 当然，如果在创建数据库连接对象时指定了连接的数据库时，就不需要再指定数据库对象： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">dbName = 你的数据库名称<br>conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>,passwd=<span class="hljs-string">&#x27;123456&#x27;</span>,charset=<span class="hljs-string">&#x27;utf8&#x27;</span>,db=dbName)<br></code></pre></td></tr></table></figure></li>
<li>数据表的创建<br> MySQL是使用SQL语句对数据库进行操作，创建表可使用： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tablename (字段名 字段属性，字段名 字段属性，……)<br></code></pre></td></tr></table></figure>
 MySQL支持的字段属性包括：</li>
<li>日期和时间数据类型。 <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">data</span>：<span class="hljs-number">3</span>字节，日期，格式：<span class="hljs-number">2014</span>-<span class="hljs-number">09</span>-<span class="hljs-number">18</span><br><span class="hljs-attribute">time</span>：<span class="hljs-number">3</span>字节，时间，格式：<span class="hljs-number">08</span>:<span class="hljs-number">42</span>:<span class="hljs-number">30</span><br><span class="hljs-attribute">datetime</span>：<span class="hljs-number">8</span>字节，日期时间，格式：<span class="hljs-number">2014</span>-<span class="hljs-number">09</span>-<span class="hljs-number">18</span> <span class="hljs-number">08</span>:<span class="hljs-number">42</span>:<span class="hljs-number">30</span><br><span class="hljs-attribute">timestamp</span>：<span class="hljs-number">4</span>字节，自动存储记录修改的时间<br><span class="hljs-attribute">year</span>：<span class="hljs-number">1</span>字节，年份<br></code></pre></td></tr></table></figure></li>
<li>数值数据类型。 <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tinyint</span>：<span class="hljs-number">1</span>字节，范围（-<span class="hljs-number">128</span>~<span class="hljs-number">127</span>）<br><span class="hljs-attribute">smallint</span>：<span class="hljs-number">2</span>字节，范围（-<span class="hljs-number">32768</span>~<span class="hljs-number">32767</span>）<br><span class="hljs-attribute">mediumint</span>：<span class="hljs-number">3</span>字节，范围（-<span class="hljs-number">8388608</span>~<span class="hljs-number">8388607</span>）<br><span class="hljs-attribute">int</span>： <span class="hljs-number">4</span>字节，范围（-<span class="hljs-number">2147483648</span>~<span class="hljs-number">2147483647</span>）<br><span class="hljs-attribute">bigint</span>：<span class="hljs-number">8</span>字节，范围（+-<span class="hljs-number">9</span>.<span class="hljs-number">22</span>*<span class="hljs-number">10</span>的<span class="hljs-number">18</span>次方）<br></code></pre></td></tr></table></figure></li>
<li>浮点型。 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">float</span><span class="hljs-params">(m, d)</span></span>：<span class="hljs-number">4</span>字节，单精度浮点型，m总个数，d小数位<br><span class="hljs-function"><span class="hljs-title">double</span><span class="hljs-params">(m, d)</span></span>：<span class="hljs-number">8</span>字节，双精度浮点型，m总个数，d小数位<br><span class="hljs-function"><span class="hljs-title">decimal</span><span class="hljs-params">(m, d)</span></span>：decimal是存储为字符串的浮点数<br></code></pre></td></tr></table></figure></li>
<li>字符串数据类型。 <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">char</span>(n)：固定长度，最多<span class="hljs-number">255</span>个字符<br><span class="hljs-attribute">varchar</span>(n)：可变长度，最多<span class="hljs-number">65535</span>个字符<br><span class="hljs-attribute">tinytext</span>：可变长度，最多<span class="hljs-number">255</span>个字符<br><span class="hljs-attribute">text</span>：可变长度，最多<span class="hljs-number">65535</span>个字符<br><span class="hljs-attribute">mediumtext</span>：可变长度，最多<span class="hljs-number">2</span>的<span class="hljs-number">24</span>次方-<span class="hljs-number">1</span>个字符<br><span class="hljs-attribute">longtext</span>：可变长度，最多<span class="hljs-number">2</span>的<span class="hljs-number">32</span>次方-<span class="hljs-number">1</span>个字符<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li>Educoder代码 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 连接数据库，建立游标cursor</span><br><span class="hljs-keyword">import</span> pymysql<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>():<br>    conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>, passwd=<span class="hljs-string">&#x27;123123&#x27;</span>, charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>    cursor = conn.cursor()<br>    <span class="hljs-comment"># -----------Begin----------</span><br>    <span class="hljs-comment"># 创建enroll数据库</span><br>    cursor.execute(<span class="hljs-string">&#x27;create database enroll&#x27;</span>)<br>    conn.select_db(<span class="hljs-string">&#x27;enroll&#x27;</span>)<br>    <span class="hljs-comment"># 创建nudt数据表</span><br>    cursor.execute(<span class="hljs-string">&#x27;create table nudt(year int,province varchar(20),firstBatch int, gcMax int, gcMean int, xlMax int, xlMin int, xlMean int)&#x27;</span>)<br>    <span class="hljs-comment"># ------------End-----------</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-9-3-批量数据入库及检索"><a href="#2-9-3-批量数据入库及检索" class="headerlink" title="2.9.3 批量数据入库及检索"></a>2.9.3 批量数据入库及检索</h3><ol>
<li>任务描述<br> 数据表创建好之后，可以将数据存入表中方便之后对数据进行分析。SQL中插入语句为insert，如往ininfo表中存入汽车购入信息： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span> <span class="hljs-operator">=</span> &quot;insert into %s (indata, inNum, brand) values (&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;)&quot; <span class="hljs-operator">%</span> (tablename, <span class="hljs-string">&#x27;2017-8-19&#x27;</span>, <span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;Chevrolet&#x27;</span>)<br>cursor.execute(<span class="hljs-keyword">sql</span>)<br></code></pre></td></tr></table></figure>
 数据插入后可以去数据库中查询，判断数据是否正确插入：   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;select * from %s&#x27;</span> <span class="hljs-operator">%</span> tablename<br>cursor.execute(<span class="hljs-keyword">sql</span>)<br>records <span class="hljs-operator">=</span> cursor.fetchall()<br></code></pre></td></tr></table></figure>
 本关任务是，向nudt表中存入国防科技大学2014在各省的录取分数线以及最高分、最低分和平均分。</li>
<li>相关知识 <ol>
<li>格式化字符串<br> 插入数据时使用insert语句，需要指定每个字段的值，如： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">sql = <span class="hljs-string">&quot;insert into %s (indata, inNum, brand) values (&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;)&quot;</span> % (tablename, <span class="hljs-string">&#x27;2017-8-19&#x27;</span>, <span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;Chevrolet&#x27;</span>)<br></code></pre></td></tr></table></figure>
 python中可以用<code>%</code>对字符串进行格式化操作，%s是优先用<code>str()</code>函数进行字符串转化，<code>%</code>左侧的字符串称为格式化字符串，右侧是希望格式化的值，格式化字符串的<code>%s</code>部分称为转换说明符，标记了需要插入转换值的位置</li>
<li>利用游标接收返回值<br> Python执行完select语句后可以从数据库中获取到数据，但需要执行fetchxxx语句后才能将数据取回本地进行操作。fetchxxx语句包括： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">fetchall()：接收全部的返回结果行<br>fetchmany(size=<span class="hljs-literal">None</span>)：接收size条返回结果行<br>fetchone()：返回一条结果行<br></code></pre></td></tr></table></figure>
 另外还可以用下面的方法移动游标： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">scroll(value, mode=<span class="hljs-string">&#x27;relative&#x27;</span>)：指针移动value条<br></code></pre></td></tr></table></figure></li>
<li>事务提交与关闭连接<br> 在完成插入之后需要将插入事务提交，否则会导致相应的表死锁： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">conn.commit()<br></code></pre></td></tr></table></figure>
 在对数据库的所有操作完成之后，需要关闭与数据库之间的连接： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">conn.close()<br></code></pre></td></tr></table></figure>
 虽然不主动关闭连接也会过期，但是会较长时间占用mysql宝贵的连接资源。</li>
</ol>
</li>
<li>Educoder代码 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pymysql<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">year,province,firstBatch,gcMax,gcMin,gcMean,xlMax,xlMin,xlMean</span>):<br>    conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>, passwd=<span class="hljs-string">&#x27;123123&#x27;</span>, charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>    cursor = conn.cursor()<br>    conn.select_db(<span class="hljs-string">&#x27;enroll&#x27;</span>)<br>    <span class="hljs-comment"># -----------Begin----------</span><br>    <span class="hljs-comment"># 请在下面输入插入数据的语句，完成相应功能</span><br>    <span class="hljs-keyword">if</span> xlMax == <span class="hljs-string">&quot;NULL&quot;</span>:<br>        xlMax = <span class="hljs-number">0</span><br>        xlMin = <span class="hljs-number">0</span><br>        xlMean = <span class="hljs-number">0</span><br><br>    sql = <span class="hljs-string">f&quot;insert into nudt (year,province,firstBatch,gcMax,gcMin,gcMean,xlMax,xlMin,xlMean) values (&#x27;<span class="hljs-subst">&#123;year&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;province&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;firstBatch&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;gcMax&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;gcMin&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;gcMean&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;xlMax&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;xlMin&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;xlMean&#125;</span>&#x27;)&quot;</span><br>    cursor.execute(sql)<br>    <span class="hljs-comment"># ------------End-----------</span><br><br>    <span class="hljs-comment"># 提交数据到数据库</span><br>    conn.commit()<br>    <span class="hljs-comment"># 关闭数据库连接</span><br>    cursor.close() <br>    conn.close()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">select</span>():<br>    conn = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>, passwd=<span class="hljs-string">&#x27;123123&#x27;</span>, charset=<span class="hljs-string">&#x27;utf8&#x27;</span>)<br>    cursor = conn.cursor()<br>    conn.select_db(<span class="hljs-string">&#x27;enroll&#x27;</span>)<br>    <span class="hljs-comment"># -----------Begin----------</span><br>    <span class="hljs-comment"># 请在下面输入查询数据的语句，完成相应功能</span><br>    sql = <span class="hljs-string">&#x27;select * from nudt&#x27;</span><br>    cursor.execute(sql)<br>    <span class="hljs-comment"># 请在下面输入获取数据的语句，完成相应功能</span><br>    records = cursor.fetchall()<br>    <span class="hljs-comment"># ------------End-----------</span><br>    <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> records:<br>        record = <span class="hljs-built_in">list</span>(record)<br>        <span class="hljs-keyword">if</span> record[<span class="hljs-number">6</span>] == <span class="hljs-number">0</span>:<br>            record[<span class="hljs-number">6</span>] = record[<span class="hljs-number">7</span>] = record[<span class="hljs-number">8</span>] = <span class="hljs-literal">None</span><br>        record = <span class="hljs-built_in">tuple</span>(record)<br>        <span class="hljs-built_in">print</span>(record)<br><br>    <span class="hljs-comment"># 关闭数据库连接</span><br>    cursor.close() <br>    conn.close()<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-9-4-多表创建与连接查询"><a href="#2-9-4-多表创建与连接查询" class="headerlink" title="2.9.4 多表创建与连接查询"></a>2.9.4 多表创建与连接查询</h3><ol>
<li>任务描述<br> 在存储信息时可能出现不能将所有信息存入同一张表中的情况，如汽车购入记录和汽车出售记录，为了查询汽车剩余数量，就需要同时获取汽车购入记录及对应的出售记录。汽车购入记录中有一个字段为brand，汽车销售记录中同样有一个brand字段，则可通过该字段将两表关联起来，获取汽车剩余数量： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> A.brand, A.inNum <span class="hljs-operator">-</span> B.outNum <span class="hljs-keyword">from</span> ininfo A, outinfo B <span class="hljs-keyword">where</span> A.brand <span class="hljs-operator">=</span> B.brand<br></code></pre></td></tr></table></figure>
 这种查询方式即为关联查询，brand为两表的共有字段。<br> 本关任务是，在enroll库中创建provincialEntryScore（各省分数线表），nudtTechScore（科大技术类分数线表），nudtMilScore（科大指挥类分数线表）三张表，往表中插入数据，并根据要求查询。</li>
<li>相关知识<ol>
<li>多表直接汇总<br> 在多表查询时，可直接将每张表中的数据全部取出汇总： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> ininfo, outinfo<br>这种查询会使得表中的一条记录出现多次，如ininfo表中有两条记录a、b，outinfo表中有两条记录c、d，则查询结果为：<br></code></pre></td></tr></table></figure>
 a c<br> a d<br> b c<br> b d<br> 另外，这种查询方式会将ininfo，outinfo两张表中的全部字段取出汇总，上述查询语句得到的结果为： <figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">`indata`，`inNum`，`brand`，`outdata`，`outNum`，`brand`<br></code></pre></td></tr></table></figure>
 当两张表没有共有字段时这种操作方式没问题，但是如果表与表之间有共有字段，如ininfo，outinfo表中的brand字段，这种查询方式会使结果中出现重复字段。</li>
<li>等值连接<br> 这种查询方式会将两张表中共有字段相同的记录连接前来输出，这种查询方式只适合于表与表之间有共有字段，即表与表之间存在关联。查询方式为： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> ininfo A, outinfo B <span class="hljs-keyword">where</span> A.brand <span class="hljs-operator">=</span> B.brand<br></code></pre></td></tr></table></figure>
 如ininfo中a的brand为Chevrolet，outinfo中b的brand为Chevrolet，则等值连接的结果为： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">a.indata，a.inNum，a.brand，b.indata，b.outNum，b.brand<br></code></pre></td></tr></table></figure>
 这种查询方式同样存在共有字段多次输出的问题。</li>
<li>自然连接<br> 自然连接查询保证多表之间的共有字段只输出一次，如： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> A.brand, A.indata, A.inNum, B.outdata, B.outNum <span class="hljs-keyword">from</span> ininfo A, outinfo B<br></code></pre></td></tr></table></figure>
 查询结果如下： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">a.brand， a.indata， a.inNum， b.outdata， b.outNum<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li>Educoder代码<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pymysql<br><br> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">cursor</span>):<br>     <span class="hljs-comment"># -----------Begin----------</span><br>     <span class="hljs-comment"># 创建provincialEntryScore表</span><br>     sql = <span class="hljs-string">&quot;create table provincialEntryScore(year int, province varchar(100),entryScore int)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># 创建nudtTechScore表</span><br>     sql = <span class="hljs-string">&quot;create table nudtTechScore(year int,province varchar(100),techMax int,techMin int, techMean int)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># 创建nudtMilScore表</span><br>     sql = <span class="hljs-string">&quot;create table nudtMilScore(year int,province varchar(100), MilMax int, MilMin int, MilMean int)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># ------------End-----------</span><br><br> <span class="hljs-keyword">def</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">cursor,year,province,entryScore,techMax,techMin,techMean,milMax,milMin,milMean</span>):<br>     <span class="hljs-comment"># -----------Begin----------</span><br>     <span class="hljs-comment"># 请在下面输入将数据插入provincialEntryScore表中的语句</span><br>     sql = <span class="hljs-string">f&quot;insert into provincialEntryScore values (&#x27;<span class="hljs-subst">&#123;year&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;province&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;entryScore&#125;</span>&#x27;)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># 请在下面输入将数据插入nudtTechScore表中的语句</span><br>     sql = <span class="hljs-string">f&quot;insert into nudtTechScore values (&#x27;<span class="hljs-subst">&#123;year&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;province&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;techMax&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;techMin&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;techMean&#125;</span>&#x27;)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># 请在下面输入将数据插入nudtMilScore表中的语句</span><br>     sql = <span class="hljs-string">f&quot;insert into nudtMilScore values (&#x27;<span class="hljs-subst">&#123;year&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;province&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;milMax&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;milMin&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;milMean&#125;</span>&#x27;)&quot;</span><br>     cursor.execute(sql)<br>     <span class="hljs-comment"># ------------End-----------</span><br><br> <span class="hljs-keyword">def</span> <span class="hljs-title function_">selectAll</span>(<span class="hljs-params">cursor</span>):<br>     <span class="hljs-comment"># -----------Begin----------</span><br>     <span class="hljs-comment"># 请在下面输入多表直接汇总的语句</span><br>     sql = <span class="hljs-string">&quot;select * from provincialEntryScore,nudtTechScore,nudtMilScore&quot;</span><br>     cursor.execute(sql)<br>     records = cursor.fetchall()<br>     <span class="hljs-keyword">return</span> records<br>     <span class="hljs-comment"># ------------End-----------</span><br><br> <span class="hljs-keyword">def</span> <span class="hljs-title function_">selectEqual</span>(<span class="hljs-params">cursor</span>):<br>     <span class="hljs-comment"># -----------Begin----------</span><br>     <span class="hljs-comment"># 请在下面输入等值连接的语句</span><br>     sql = <span class="hljs-string">&quot;select * from provincialEntryScore a,nudtTechScore b,nudtMilScore c where a.province=b.province and a.province=c.province&quot;</span><br>     cursor.execute(sql)<br>     records = cursor.fetchall()<br>     <span class="hljs-keyword">return</span> records<br>     <span class="hljs-comment"># ------------End-----------</span><br><br> <span class="hljs-keyword">def</span> <span class="hljs-title function_">selectNatural</span>(<span class="hljs-params">cursor</span>):<br>     <span class="hljs-comment"># -----------Begin----------</span><br>     <span class="hljs-comment"># 请在下面输入自然连接的语句</span><br>     sql = <span class="hljs-string">&quot;select a.year,a.province,a.entryScore,b.techMax,b.techMin,b.techMean,c.MilMax,c.MilMin,c.MilMean from provincialEntryScore a,nudtTechScore b,nudtMilScore c where a.province=b.province and a.province=c.province&quot;</span><br>     cursor.execute(sql)<br>     records = cursor.fetchall()<br>     <span class="hljs-keyword">return</span> records<br>     <span class="hljs-comment"># ------------End-----------</span><br><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-10-查询、索引和完整性"><a href="#2-10-查询、索引和完整性" class="headerlink" title="2.10 查询、索引和完整性"></a>2.10 查询、索引和完整性</h2><h3 id="2-10-1-基本查询的学习"><a href="#2-10-1-基本查询的学习" class="headerlink" title="2.10.1 基本查询的学习"></a>2.10.1 基本查询的学习</h3><ol>
<li>查询语句select<br> 以下是MySQL数据库中查询数据通用的SELECT语法： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column_name1,column_name2 <span class="hljs-keyword">FROM</span> table_name [<span class="hljs-keyword">WHERE</span> Clause] [<span class="hljs-keyword">OFFSET</span> M ] [LIMIT N]<br></code></pre></td></tr></table></figure>
<ul>
<li>查询语句中可以指定一个或者多个表，表之间使用逗号,分割，并使用WHERE语句来设定查询条件</li>
<li>SELECT命令可以读取一条或者多条记录</li>
<li>可以使用星号*来代替字段，返回表所有字段的数据</li>
<li>可以使用LIMIT属性来设定返回的记录数。</li>
</ul>
</li>
<li>命令行的操作</li>
<li>子查询的使用<br> 所谓子查询，即在查询语句中内嵌其他查询语句。下面，我们仍继续在命令行的操作中学习。<br> 查找在cwb工作的雇员情况： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> did<span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> did <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;cwb&#x27;</span>);<br></code></pre></td></tr></table></figure></li>
<li>连接查询的使用<br> 比如查询每个雇员的薪水情况，但是我们要返回雇员的姓名，而在sal表中没有雇员姓名，这个时候就需要我们通过员工编号连接emp和sal两张表。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> emp.ename,sal.income <span class="hljs-keyword">from</span> emp,sal <span class="hljs-keyword">where</span> emp.eid<span class="hljs-operator">=</span>sal.eid;<br></code></pre></td></tr></table></figure></li>
<li>一些关键字<ul>
<li>any关键字：<br> 假设any内部的查询语句返回的结果个数是三个，那么： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> ...<span class="hljs-keyword">from</span> ... <span class="hljs-keyword">where</span> a <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">any</span>(...)<br></code></pre></td></tr></table></figure>
 等价于 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> ...<span class="hljs-keyword">from</span> ... <span class="hljs-keyword">where</span> a <span class="hljs-operator">&gt;</span> result1 <span class="hljs-keyword">or</span> a <span class="hljs-operator">&gt;</span> result2 <span class="hljs-keyword">or</span> a <span class="hljs-operator">&gt;</span> result3<br></code></pre></td></tr></table></figure>
 ALL关键字与any关键字类似，但其含义不同，相当于上面的or改成and。some关键字和any关键字是一样的功能。</li>
<li>IN运算符用于WHERE表达式中，以列表项的形式支持多个选择 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">column</span> <span class="hljs-keyword">IN</span> (value1,value2,...)<br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">column</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (value1,value2,...)<br></code></pre></td></tr></table></figure>
 当IN前面加上NOT运算符时，表示与IN相反的意思，即不在这些列表项内选择。</li>
<li>UNION操作符用于连接两个以上的SELECT语句的结果组合到一个结果集合中 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> expression_1,expression_2,...,expression_n <span class="hljs-keyword">FROM</span> tables [<span class="hljs-keyword">WHERE</span> conditions]<br><span class="hljs-keyword">UNION</span> [<span class="hljs-keyword">ALL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DISTINCT</span>]<br><span class="hljs-keyword">SELECT</span> expression_1,expression_2,...,expression_n <span class="hljs-keyword">FROM</span> tables[<span class="hljs-keyword">WHERE</span> conditions];<br></code></pre></td></tr></table></figure>
 参数expression_1, expression_2, … expression_n是要检索的列，tables是要检索的数据表，WHERE conditions是检索条件，DISTINCT是删除结果集中重复的数据。默认情况下 UNION操作符已经删除了重复数据，所以DISTINCT修饰符对结果没啥影响。而ALL可以返回所有结果集，包含重复数据。</li>
</ul>
</li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面补齐查询一的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">select</span> ename,eid,sex <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span>   <br>did <span class="hljs-keyword">in</span> (<br>    <span class="hljs-keyword">select</span> did <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;cwb&#x27;</span><br>)<br><span class="hljs-comment">/*********end*********/</span><br>    <span class="hljs-keyword">and</span><br>    birth<span class="hljs-operator">&lt;=</span><span class="hljs-keyword">all</span><br>        (<span class="hljs-keyword">select</span> birth <span class="hljs-keyword">from</span> emp<br>            <span class="hljs-keyword">where</span> did <span class="hljs-keyword">in</span><br>                (<span class="hljs-keyword">select</span> did <span class="hljs-keyword">from</span> dept<br>                    <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;yfb&#x27;</span><br>                )<br>        );<br><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入查询二的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">select</span> emp.ename,sal.income,sal.outcome <span class="hljs-keyword">from</span> emp,sal<br><span class="hljs-keyword">where</span> emp.eid<span class="hljs-operator">=</span>sal.eid <span class="hljs-keyword">and</span> emp.did <span class="hljs-keyword">in</span> (<br>    <span class="hljs-keyword">select</span> did <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;cwb&#x27;</span><br>) <span class="hljs-keyword">and</span> sal.income<span class="hljs-operator">&gt;</span><span class="hljs-number">5200</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-10-2-深入学习查询语句"><a href="#2-10-2-深入学习查询语句" class="headerlink" title="2.10.2 深入学习查询语句"></a>2.10.2 深入学习查询语句</h3><ol>
<li>MySQL聚集函数<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">COUNT()</td>
<td align="center">返回某列的行数</td>
</tr>
<tr>
<td align="center">MAX()</td>
<td align="center">返回某列最大值</td>
</tr>
<tr>
<td align="center">MIN()</td>
<td align="center">返回某列最小值</td>
</tr>
<tr>
<td align="center">AVG()</td>
<td align="center">返回某列平均值</td>
</tr>
<tr>
<td align="center">SUM()</td>
<td align="center">返回某列值之和</td>
</tr>
</tbody></table>
 求财务部雇员的平均收入： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(income) <span class="hljs-keyword">as</span> avgincome<br>    <span class="hljs-keyword">from</span> sal<br>    <span class="hljs-keyword">where</span> eid <span class="hljs-keyword">in</span><br>        (<span class="hljs-keyword">select</span> eid<br>            <span class="hljs-keyword">from</span> emp<br>                <span class="hljs-keyword">where</span> did<span class="hljs-operator">=</span><br>                    (<span class="hljs-keyword">select</span> did<br>                        <span class="hljs-keyword">from</span> dept<br>                            <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;cwb&#x27;</span>));<br></code></pre></td></tr></table></figure></li>
<li>group by和order by子句的使用<br> GROUP BY语句根据一个或多个列对结果集进行分组。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column_name, <span class="hljs-keyword">function</span>(column_name) <span class="hljs-keyword">FROM</span> table_name <span class="hljs-keyword">WHERE</span> column_name operator <span class="hljs-keyword">value</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column_name;<br></code></pre></td></tr></table></figure>
 如果我们需要对读取的数据进行排序，我们就可以使用MySQL的ORDER BY子句来设定你想按哪个字段哪种方式来进行排序，再返回搜索结果。 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> field1, field2,...,fieldN table_name1,table_name2..., <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> field1,[field2...] [<span class="hljs-keyword">ASC</span> [<span class="hljs-keyword">DESC</span>]]<br></code></pre></td></tr></table></figure>
<ul>
<li>你可以设定多个字段来排序。</li>
<li>你可以使用 ASC （升序）或 DESC（降序） 关键字来设置查询结果是按升序或降序排列。 默认情况下，它是按升序排列。</li>
<li>你可以添加 WHERE…LIKE 子句来设置条件。</li>
</ul>
</li>
<li>Educoder代码 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入查询一的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> did <span class="hljs-keyword">in</span> (<br>    <span class="hljs-keyword">select</span> did <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> dname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;cwb&#x27;</span><br>);<br><br><span class="hljs-comment">/*********end*********/</span><br><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入查询二的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> did;<br><br><span class="hljs-comment">/*********end*********/</span><br><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入查询三的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><br><span class="hljs-keyword">select</span> emp.ename <span class="hljs-keyword">from</span> emp,sal <span class="hljs-keyword">where</span> emp.eid<span class="hljs-operator">=</span>sal.eid <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> sal.income ;<br><br><span class="hljs-comment">/*********end*********/</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-10-3-视图的创建和使用"><a href="#2-10-3-视图的创建和使用" class="headerlink" title="2.10.3 视图的创建和使用"></a>2.10.3 视图的创建和使用</h3><ol>
<li><p>相关知识<br> 限制查看雇员的某些情况：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> replace <span class="hljs-keyword">view</span> cx_emp<br><span class="hljs-keyword">as</span><br>    <span class="hljs-keyword">select</span> eid,ename,birth,sex,did<br>        <span class="hljs-keyword">from</span> emp;<br></code></pre></td></tr></table></figure>

<p> 创建该视图后，我们可以在数据库中查看所有的表，是不是变成了下面这样？<br> <img src="/../img/Educoder_MySQL%E5%AD%A6%E4%B9%A0/2.10.3-1.png" srcset="/img/loading.gif" lazyload><br> 接下来我们输入下面的命令来查看该视图：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> cx_emp;<br></code></pre></td></tr></table></figure>
<p> 为了了解视图的特性，我们向视图cx_emp中插入一条记录：</p>
<table>
<thead>
<tr>
<th align="center">eid</th>
<th align="center">ename</th>
<th align="center">birth</th>
<th align="center">sex</th>
<th align="center">did</th>
</tr>
</thead>
<tbody><tr>
<td align="center">888</td>
<td align="center">zhj</td>
<td align="center">1983-09-25</td>
<td align="center">1</td>
<td align="center">3</td>
</tr>
</tbody></table>
<p> 现在，我们查看一下emp表，你是不是已经成功把这条记录插入到emp表中了呢？这就是视图，原表和视图之间是同步的。<br> 接下来请你尝试以下操作。<br> 将zhj从经理办公室（部门编号3）转到市场部（部门编号为5）：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> cx_emp <span class="hljs-keyword">set</span> did<span class="hljs-operator">=</span><span class="hljs-string">&#x27;5&#x27;</span><br>    <span class="hljs-keyword">where</span> ename<span class="hljs-operator">=</span><span class="hljs-string">&#x27;zhj&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p> 请你再次查看emp表核查是否修改成功。</p>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入创建cx_sal的视图的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> cx_sal <span class="hljs-keyword">as</span><br><span class="hljs-keyword">select</span> emp.ename,sal.income,sal.outcome<br><span class="hljs-keyword">from</span> emp,sal<br><span class="hljs-keyword">where</span> emp.eid<span class="hljs-operator">=</span>sal.eid;<br><br><span class="hljs-comment">/*********end*********/</span><br><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入查询财务部雇员薪水情况视图的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> cx_sal;<br><span class="hljs-comment">/*********end*********/</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-10-4-索引和完整性"><a href="#2-10-4-索引和完整性" class="headerlink" title="2.10.4 索引和完整性"></a>2.10.4 索引和完整性</h3><ol>
<li><p>索引<br> 索引是根据表中一列或若干列按照一定的顺序建立的列值与记录行之间的对应关系表。在列上创建了索引之后，查找数据是可以直接根据该列上的索引找到对应行的位置，从而快速找到数据。<br> 索引类型分成下列几个：</p>
<ul>
<li>普通索引（INDEX）：基本索引类型</li>
<li>唯一性索引（UNIQUE）：该列的所有值没有重复</li>
<li>主键（PRIMARY KEY）：一种唯一性索引，一个表只能有一个主键</li>
<li>全文索引（FLLTEXT）：只能在varchar或text类型上创建</li>
</ul>
<p> 语法格式：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>创建<br><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">UNIQUE</span><span class="hljs-operator">|</span>FULLTEXT<span class="hljs-operator">|</span>SPATIAL] INDEX 索引名称 <span class="hljs-keyword">ON</span> 表名&#123;字段名称[(长度)] [<span class="hljs-keyword">ASC</span><span class="hljs-operator">|</span><span class="hljs-keyword">DESC</span>]&#125;<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>修改<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> tbl_name <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">UNIQUE</span><span class="hljs-operator">|</span>FULLTEXT<span class="hljs-operator">|</span>SPATIAL] INDEX索引名称(字段名称[(长度)][<span class="hljs-keyword">ASC</span><span class="hljs-operator">|</span><span class="hljs-keyword">DESC</span>]);<br></code></pre></td></tr></table></figure><br> 在创建好整个数据库的基础上，对YGGL数据库的emp表的ename列建立索引：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> index emp_name_idx<br>    <span class="hljs-keyword">on</span> emp(ename);<br></code></pre></td></tr></table></figure><br> 查看是否创建成功：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> emp;<br></code></pre></td></tr></table></figure><br> 重命名索引：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> index emp_name_idx<br>    rename <span class="hljs-keyword">to</span> emp_idx;<br></code></pre></td></tr></table></figure><br> 删除索引：<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> index emp_idex;<br></code></pre></td></tr></table></figure></p>
</li>
<li><p>数据完整性<br> 为了防止不合规定的数据进入基表中，我们定义完整性规则。分为：域完整性、实体完整性和参照完整性。</p>
<ol>
<li>域完整性<br> 域完整性又叫列完整性，主要是对一列的数据进行约束。比如emp中限定sex的值只能为1和2中的一个，可以在创建表时将sex做以下定义： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sex <span class="hljs-type">int</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">check</span>(sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br></code></pre></td></tr></table></figure>
 或者在所有字段定义完成后加一句： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">constraint</span> ch_sex <span class="hljs-keyword">check</span>(sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;2&#x27;</span>)<br></code></pre></td></tr></table></figure>
 下面，我们在命令行中通过修改表的方式创建约束： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br>    <span class="hljs-keyword">add</span>(<span class="hljs-keyword">constraint</span> ch_sex <span class="hljs-keyword">check</span>(sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> sex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;2&#x27;</span>));<br></code></pre></td></tr></table></figure>
 删除约束： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br>    <span class="hljs-keyword">drop</span> <span class="hljs-keyword">constraint</span> ch_sex;<br></code></pre></td></tr></table></figure></li>
<li>实体完整性<br> 又叫行完整性，要求每一行都有一个唯一的标识符。比如emp中的员工eid是唯一的，才能唯一确定某一个人。通过unique约束和primary key约束可以实现实体完整性。<br> 同样的，在创建表时对tel创建约束应该将tel定义为： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">tel    <span class="hljs-type">char</span>(<span class="hljs-number">12</span>)     <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">constraint</span> un_tel <span class="hljs-keyword">unique</span>,<br></code></pre></td></tr></table></figure>
 下面我们在命令行中通过修改表的方式创建约束： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br>    <span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> un_tel <span class="hljs-keyword">unique</span>(tel);<br></code></pre></td></tr></table></figure></li>
<li>参照完整性<br> 又叫引用完整性，它保证主表和从表中的数据一致性，实现方式是定义外键与主键。例如emp和sal表，eid在emp中是外键，而在sal中eid定义为主键。</li>
</ol>
<ul>
<li>从表不能引用主表不存在的键值</li>
<li>主表中的值更改了，则从表中所有引用都也要修改</li>
<li>若要删除主表中的记录，应先删除从表中匹配的记录<br> 如果在创建sal表时想创建参照完整性使emp表中所有eid都要出现在sal中,可以在定义emp的eid时这样定义： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">eid    <span class="hljs-type">char</span>(<span class="hljs-number">6</span>)      <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">references</span> sal(eid),<br></code></pre></td></tr></table></figure>
 下面我们在命令行中通过修改表的方式定义： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br>    <span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> sal_id <span class="hljs-keyword">foreign</span> key(eid)<br>        <span class="hljs-keyword">references</span> sal(eid);<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Educoder代码</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入创建索引的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">create</span> index pk_xs_bak <span class="hljs-keyword">on</span> emp(eid);<br><span class="hljs-comment">/*********end*********/</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入实现域完整性的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br><span class="hljs-keyword">add</span> (<span class="hljs-keyword">constraint</span> ch_tel <span class="hljs-keyword">check</span>(tel <span class="hljs-keyword">between</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">9</span>));<br><span class="hljs-comment">/*********end*********/</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入实现实体完整性的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> dept<br><span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> undept <span class="hljs-keyword">unique</span>(dname);<br><span class="hljs-comment">/*********end*********/</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>请在下面输入实现参照完整性的MySQL语句<br><span class="hljs-comment">/*********begin*********/</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br><span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> fk_emp <span class="hljs-keyword">foreign</span> key(did)<br><span class="hljs-keyword">references</span> dept(did);<br><span class="hljs-comment">/*********end*********/</span><br></code></pre></td></tr></table></figure></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" class="category-chain-item">技术学习</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/MySQL/" class="print-no-link">#MySQL</a>
      
        <a href="/tags/Educoder/" class="print-no-link">#Educoder</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Educoder MySQL学习</div>
      <div>http://diba0.github.io/2024/09/28/Educoder-Mysql学习/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>diba0</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年9月28日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/09/28/git%E5%AD%A6%E4%B9%A0/" title="git学习">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">git学习</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/19/%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%E7%BB%93%E6%9E%9C/" title="第一阶段结果">
                        <span class="hidden-mobile">第一阶段结果</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'diba0/diba0.github.io');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
